<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Two-Round Threshold Schnorr Signatures with FROST</title>
<meta content="Deirdre Connolly" name="author">
<meta content="Chelsea Komlo" name="author">
<meta content="Ian Goldberg" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       In this draft, we present the two-round signing variant of FROST, a Flexible Round-Optimized
Schnorr Threshold signature scheme. FROST signatures can be issued after a threshold number
of entities cooperate to issue a signature, allowing for improved distribution of trust and
redundancy with respect to a secret key. Further, this draft specifies signatures that are
compatible with  . However, unlike  , the protocol for producing
signatures in this draft is not deterministic, so as to ensure protection against a
key-recovery attack that is possible when even only one participant is malicious. 
    " name="description">
<meta content="xml2rfc 3.14.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-cfrg-frost-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.14.2
    Python 3.10.5
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.1
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
-->
<link href="draft-irtf-cfrg-frost.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 20ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
dl .break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">FROST</td>
<td class="right">September 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Connolly, et al.</td>
<td class="center">Expires 20 March 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CFRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-frost-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-09-16" class="published">16 September 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-03-20">20 March 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Connolly</div>
<div class="org">Zcash Foundation</div>
</div>
<div class="author">
      <div class="author-name">C. Komlo</div>
<div class="org">University of Waterloo, Zcash Foundation</div>
</div>
<div class="author">
      <div class="author-name">I. Goldberg</div>
<div class="org">University of Waterloo</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Two-Round Threshold Schnorr Signatures with FROST</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">In this draft, we present the two-round signing variant of FROST, a Flexible Round-Optimized
Schnorr Threshold signature scheme. FROST signatures can be issued after a threshold number
of entities cooperate to issue a signature, allowing for improved distribution of trust and
redundancy with respect to a secret key. Further, this draft specifies signatures that are
compatible with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. However, unlike <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, the protocol for producing
signatures in this draft is not deterministic, so as to ensure protection against a
key-recovery attack that is possible when even only one participant is malicious.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Crypto Forum Research Group mailing list (cfrg@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/search/?email_list=cfrg">https://mailarchive.ietf.org/arch/search/?email_list=cfrg</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/cfrg/draft-irtf-cfrg-frost">https://github.com/cfrg/draft-irtf-cfrg-frost</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 March 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-definitions" class="xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-cryptographic-dependencies" class="xref">Cryptographic Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-prime-order-group" class="xref">Prime-Order Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-cryptographic-hash-function" class="xref">Cryptographic Hash Function</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-helper-functions" class="xref">Helper functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-nonce-generation" class="xref">Nonce generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-polynomial-operations" class="xref">Polynomial Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-evaluation-of-a-polynomial" class="xref">Evaluation of a polynomial</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-lagrange-coefficients" class="xref">Lagrange coefficients</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-deriving-the-constant-term-" class="xref">Deriving the constant term of a polynomial</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-list-operations" class="xref">List Operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-binding-factors-computation" class="xref">Binding Factors Computation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-group-commitment-computatio" class="xref">Group Commitment Computation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-signature-challenge-computa" class="xref">Signature Challenge Computation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-two-round-frost-signing-pro" class="xref">Two-Round FROST Signing Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-round-one-commitment" class="xref">Round One - Commitment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-round-two-signature-share-g" class="xref">Round Two - Signature Share Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-signature-share-verificatio" class="xref">Signature Share Verification and Aggregation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-frosted25519-sha-512" class="xref">FROST(Ed25519, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-frostristretto255-sha-512" class="xref">FROST(ristretto255, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-frosted448-shake256" class="xref">FROST(Ed448, SHAKE256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-frostp-256-sha-256" class="xref">FROST(P-256, SHA-256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-frostsecp256k1-sha-256" class="xref">FROST(secp256k1, SHA-256)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-nonce-reuse-attacks" class="xref">Nonce Reuse Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-protocol-failures" class="xref">Protocol Failures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-removing-the-coordinator-ro" class="xref">Removing the Coordinator Role</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-input-message-validation" class="xref">Input Message Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-schnorr-signature-verificat" class="xref">Schnorr Signature Verification for Prime-Order Groups</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-trusted-dealer-key-generati" class="xref">Trusted Dealer Key Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-shamir-secret-sharing" class="xref">Shamir Secret Sharing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-verifiable-secret-sharing" class="xref">Verifiable Secret Sharing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-random-scalar-generation" class="xref">Random Scalar Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-D.1" class="xref">D.1</a>.  <a href="#name-rejection-sampling" class="xref">Rejection Sampling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-D.2" class="xref">D.2</a>.  <a href="#name-wide-reduction" class="xref">Wide Reduction</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="xref">Appendix E</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-E.1" class="xref">E.1</a>.  <a href="#name-frosted25519-sha-512-2" class="xref">FROST(Ed25519, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-E.2" class="xref">E.2</a>.  <a href="#name-frosted448-shake256-2" class="xref">FROST(Ed448, SHAKE256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-E.3" class="xref">E.3</a>.  <a href="#name-frostristretto255-sha-512-2" class="xref">FROST(ristretto255, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-E.4" class="xref">E.4</a>.  <a href="#name-frostp-256-sha-256-2" class="xref">FROST(P-256, SHA-256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#appendix-E.5" class="xref">E.5</a>.  <a href="#name-frostsecp256k1-sha-256-2" class="xref">FROST(secp256k1, SHA-256)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-F" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: This is a work-in-progress draft of FROST.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this draft is
maintained in GitHub. Suggested changes should be submitted as pull requests
at https://github.com/cfrg/draft-irtf-cfrg-frost. Instructions are on that page as
well.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Unlike signatures in a single-party setting, threshold signatures
require cooperation among a threshold number of signers each holding a share
of a common private key. The security of threshold schemes in general assume
that an adversary can corrupt strictly fewer than a threshold number of participants.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document presents a variant of a Flexible Round-Optimized Schnorr Threshold (FROST)
signature scheme originally defined in <span>[<a href="#FROST20" class="xref">FROST20</a>]</span>. FROST reduces network overhead during
threshold signing operations while employing a novel technique to protect against forgery
attacks applicable to prior Schnorr-based threshold signature constructions. The variant of
FROST presented in this document requires two rounds to compute a signature. Single-round
signing with FROST is out of scope.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">For select ciphersuites, the signatures produced by this draft are compatible with
<span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. However, unlike <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, signatures produced by FROST are not
deterministic, since deriving nonces deterministically allows for a complete key-recovery
attack in multi-party discrete logarithm-based signatures, such as FROST.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">While an optimization to FROST was shown in <span>[<a href="#Schnorr21" class="xref">Schnorr21</a>]</span> that reduces scalar multiplications
from linear in the number of signers to constant, this draft does not specify that optimization
due to the malleability that this optimization introduces, as shown in <span>[<a href="#StrongerSec22" class="xref">StrongerSec22</a>]</span>.
Specifically, this optimization removes the guarantee that the set of signers that started
round one of the protocol is the same set of signers that produced the signature output by
round two.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Key generation for FROST signing is out of scope for this document. However, for completeness,
key generation with a trusted dealer is specified in <a href="#dep-dealer" class="xref">Appendix C</a>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="change-log">
<section id="section-1.1">
        <h3 id="name-change-log">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
        </h3>
<p id="section-1.1-1">draft-08<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">Add notation for Scalar multiplication (#237)<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">Add secp2561k1 ciphersuite (#223)<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">Remove RandomScalar implementation details (#231)<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.4">Add domain separation for message and commitment digests (#228)<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-3">draft-07<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Fix bug in per-rho signer computation (#222)<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5">draft-06<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-6.1">Make verification a per-ciphersuite functionality (#219)<a href="#section-1.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.2">Use per-signer values of rho to mitigate protocol malleability (#217)<a href="#section-1.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.3">Correct prime-order subgroup checks (#215, #211)<a href="#section-1.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.4">Fix bug in ed25519 ciphersuite description (#205)<a href="#section-1.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.5">Various editorial improvements (#208, #209, #210, #218)<a href="#section-1.1-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-7">draft-05<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-8.1">Update test vectors to include version string (#202, #203)<a href="#section-1.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.2">Rename THRESHOLD_LIMIT to MIN_SIGNERS (#192)<a href="#section-1.1-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.3">Use non-contiguous signers for the test vectors (#187)<a href="#section-1.1-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.4">Add more reasoning why the coordinator MUST abort (#183)<a href="#section-1.1-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.5">Add a function to generate nonces (#182)<a href="#section-1.1-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.6">Add MUST that all participants have the same view of VSS commitment (#174)<a href="#section-1.1-8.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.7">Use THRESHOLD_LIMIT instead of t and MAX_SIGNERS instead of n (#171)<a href="#section-1.1-8.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.8">Specify what the dealer is trusted to do (#166)<a href="#section-1.1-8.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.9">Clarify types of NUM_SIGNERS and THRESHOLD_LIMIT (#165)<a href="#section-1.1-8.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.10">Assert that the network channel used for signing should be authenticated (#163)<a href="#section-1.1-8.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.11">Remove wire format section (#156)<a href="#section-1.1-8.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.12">Update group commitment derivation to have a single scalarmul (#150)<a href="#section-1.1-8.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.13">Use RandomNonzeroScalar for single-party Schnorr example (#148)<a href="#section-1.1-8.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.14">Fix group notation and clarify member functions (#145)<a href="#section-1.1-8.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.15">Update existing implementations table (#136)<a href="#section-1.1-8.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.16">Various editorial improvements (#135, #143, #147, #149, #153, #158, #162, #167, #168, #169, #170, #175, #176, #177, #178, #184, #186, #193, #198, #199)<a href="#section-1.1-8.16" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-9">draft-04<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-10.1">Added methods to verify VSS commitments and derive group info (#126, #132).<a href="#section-1.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.2">Changed check for participants to consider only nonnegative numbers (#133).<a href="#section-1.1-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.3">Changed sampling for secrets and coefficients to allow the zero element (#130).<a href="#section-1.1-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.4">Split test vectors into separate files (#129)<a href="#section-1.1-10.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.5">Update wire structs to remove commitment shares where not necessary (#128)<a href="#section-1.1-10.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.6">Add failure checks (#127)<a href="#section-1.1-10.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.7">Update group info to include each participant's key and clarify how public key material is obtained (#120, #121).<a href="#section-1.1-10.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.8">Define cofactor checks for verification (#118)<a href="#section-1.1-10.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.9">Various editorial improvements and add contributors (#124, #123, #119, #116, #113, #109)<a href="#section-1.1-10.9" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-11">draft-03<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-12.1">Refactor the second round to use state from the first round (#94).<a href="#section-1.1-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.2">Ensure that verification of signature shares from the second round uses commitments from the first round (#94).<a href="#section-1.1-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.3">Clarify RFC8032 interoperability based on PureEdDSA (#86).<a href="#section-1.1-12.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.4">Specify signature serialization based on element and scalar serialization (#85).<a href="#section-1.1-12.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.5">Fix hash function domain separation formatting (#83).<a href="#section-1.1-12.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.6">Make trusted dealer key generation deterministic (#104).<a href="#section-1.1-12.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.7">Add additional constraints on participant indexes and nonce usage (#105, #103, #98, #97).<a href="#section-1.1-12.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-12.8">Apply various editorial improvements.<a href="#section-1.1-12.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-13">draft-02<a href="#section-1.1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-14.1">Fully specify both rounds of FROST, as well as trusted dealer key generation.<a href="#section-1.1-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-14.2">Add ciphersuites and corresponding test vectors, including suites for RFC8032 compatibility.<a href="#section-1.1-14.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-14.3">Refactor document for editorial clarity.<a href="#section-1.1-14.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-15">draft-01<a href="#section-1.1-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-16.1">Specify operations, notation and cryptographic dependencies.<a href="#section-1.1-16.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-17">draft-00<a href="#section-1.1-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-18.1">Outline CFRG draft based on draft-komlo-frost.<a href="#section-1.1-18.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following terminology is used throughout this document.<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">A participant is an entity that is trusted to hold and use a signing key share.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">
          <code>MAX_SIGNERS</code> denotes the number of participants, and the number of shares that <code>s</code> is split into. This value MUST NOT exceed 2^16-1.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">
          <code>MIN_SIGNERS</code> denotes the threshold number of participants required to issue a signature, where MIN_SIGNERS &lt;= MAX_SIGNERS.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">
          <code>NUM_SIGNERS</code> denotes the number of signers that participate in an invocation of FROST signing, where
MIN_SIGNERS &lt;= NUM_SIGNERS &lt;= MAX_SIGNERS.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.5">An identifier is an integer value associated with a participant, or signer,
and is a value in the range [1, MAX_SIGNERS].<a href="#section-2-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">Additionally, the following notation is used throughout the document.<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">
          <code>encode_uint16(x)</code>: Convert two byte unsigned integer (uint16) <code>x</code> to a 2-byte,
big-endian byte string. For example, <code>encode_uint16(310) = [0x01, 0x36]</code>.<a href="#section-2-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.2">
          <code>random_bytes(n)</code>: Outputs <code>n</code> bytes, sampled uniformly at random
using a cryptographically secure pseudorandom number generator (CSPRNG).<a href="#section-2-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.3">
          <code>len(l)</code>: Outputs the length of input list <code>l</code>, e.g., <code>len([1,2,3]) = 3)</code>.<a href="#section-2-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.4">
          <code>reverse(l)</code>: Outputs the list <code>l</code> in reverse order, e.g., <code>reverse([1,2,3]) = [3,2,1]</code>.<a href="#section-2-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.5">
          <code>range(a, b)</code>: Outputs a list of integers from <code>a</code> to <code>b-1</code> in ascending order, e.g., <code>range(1, 4) = [1,2,3]</code>.<a href="#section-2-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.6">
          <code>pow(a, b)</code>: Output the integer result of <code>a</code> to the power of <code>b</code>, e.g., <code>pow(2, 3) = 8</code>.<a href="#section-2-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.7">|| denotes concatenation, i.e., x || y = xy.<a href="#section-2-5.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.8">nil denotes an empty byte string.<a href="#section-2-5.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-6">Unless otherwise stated, we assume that secrets are sampled uniformly at random
using a cryptographically secure pseudorandom number generator (CSPRNG); see
<span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span> for additional guidance on the generation of random numbers.<a href="#section-2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptographic-dependencies">
<section id="section-3">
      <h2 id="name-cryptographic-dependencies">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-cryptographic-dependencies" class="section-name selfRef">Cryptographic Dependencies</a>
      </h2>
<p id="section-3-1">FROST signing depends on the following cryptographic constructs:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Prime-order Group, <a href="#dep-pog" class="xref">Section 3.1</a>;<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Cryptographic hash function, <a href="#dep-hash" class="xref">Section 3.2</a>;<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">These are described in the following sections.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="dep-pog">
<section id="section-3.1">
        <h3 id="name-prime-order-group">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-prime-order-group" class="section-name selfRef">Prime-Order Group</a>
        </h3>
<p id="section-3.1-1">FROST depends on an abelian group of prime order <code>p</code>. We represent this
group as the object <code>G</code> that additionally defines helper functions described below. The group operation
for <code>G</code> is addition <code>+</code> with identity element <code>I</code>. For any elements <code>A</code> and <code>B</code> of the group <code>G</code>,
<code>A + B = B + A</code> is also a member of <code>G</code>. Also, for any <code>A</code> in <code>G</code>, there exists an element
<code>-A</code> such that <code>A + (-A) = (-A) + A = I</code>. For convenience, we use <code>-</code> to denote
subtraction, e.g., <code>A - B = A + (-B)</code>. Scalar multiplication is equivalent to the repeated
application of the group operation on an element <code>A</code> with itself <code>r-1</code> times, denoted as
<code>ScalarBaseMult(A, r)</code>. We denote the sum, difference, and product of two scalars using the <code>+</code>, <code>-</code>,
and <code>*</code> operators, respectively. (Note that this means <code>+</code> may refer to group element addition or
scalar addition, depending on types of the operands.) For any element <code>A</code>, <code>ScalarBaseMult(A, p) = I</code>.
We denote <code>B</code> as a fixed generator of the group. Scalar base multiplication is equivalent to the repeated application
of the group operation <code>B</code> with itself <code>r-1</code> times, this is denoted as <code>ScalarBaseMult(r)</code>. The set of
scalars corresponds to <code>GF(p)</code>, which we refer to as the scalar field. This document uses types
<code>Element</code> and <code>Scalar</code> to denote elements of the group <code>G</code> and its set of scalars, respectively.
We denote Scalar(x) as the conversion of integer input <code>x</code> to the corresponding Scalar value with
the same numeric value. For example, Scalar(1) yields a Scalar representing the value 1.
We denote equality comparison as <code>==</code> and assignment of values by <code>=</code>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">We now detail a number of member functions that can be invoked on <code>G</code>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">Order(): Outputs the order of <code>G</code> (i.e. <code>p</code>).<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.2">Identity(): Outputs the identity <code>Element</code> of the group (i.e. <code>I</code>).<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.3">RandomScalar(): Outputs a random <code>Scalar</code> element in GF(p).<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.4">ScalarMult(A, k): Output the scalar multiplication between Element <code>A</code> and Scalar <code>k</code>.<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.5">ScalarBaseMult(A): Output the scalar multiplication between Element <code>A</code> and the group generator <code>B</code>.<a href="#section-3.1-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.6">SerializeElement(A): Maps an <code>Element</code> <code>A</code> to a unique byte array <code>buf</code> of fixed length <code>Ne</code>.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.7">DeserializeElement(buf): Attempts to map a byte array <code>buf</code> to an <code>Element</code> <code>A</code>,
and fails if the input is not a valid byte representation of an element of
the group. This function can raise a DeserializeError if deserialization fails
or <code>A</code> is the identity element of the group; see <a href="#ciphersuites" class="xref">Section 6</a> for group-specific
input validation steps.<a href="#section-3.1-3.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.8">SerializeScalar(s): Maps a Scalar <code>s</code> to a unique byte array <code>buf</code> of fixed length <code>Ns</code>.<a href="#section-3.1-3.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.9">DeserializeScalar(buf): Attempts to map a byte array <code>buf</code> to a <code>Scalar</code> <code>s</code>.
This function can raise a DeserializeError if deserialization fails; see
<a href="#ciphersuites" class="xref">Section 6</a> for group-specific input validation steps.<a href="#section-3.1-3.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="dep-hash">
<section id="section-3.2">
        <h3 id="name-cryptographic-hash-function">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cryptographic-hash-function" class="section-name selfRef">Cryptographic Hash Function</a>
        </h3>
<p id="section-3.2-1">FROST requires the use of a cryptographically secure hash function, generically
written as H, which functions effectively as a random oracle. For concrete
recommendations on hash functions which SHOULD be used in practice, see
<a href="#ciphersuites" class="xref">Section 6</a>. Using H, we introduce separate domain-separated hashes,
H1, H2, H3, H4, and H5:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">H1, H2, and H3 map arbitrary byte strings to Scalar elements of the prime-order group scalar field.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">H4 and H5 are aliases for H with distinct domain separators.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-3">The details of H1, H2, H3, H4, and H5 vary based on ciphersuite. See <a href="#ciphersuites" class="xref">Section 6</a>
for more details about each.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="helpers">
<section id="section-4">
      <h2 id="name-helper-functions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-helper-functions" class="section-name selfRef">Helper functions</a>
      </h2>
<p id="section-4-1">Beyond the core dependencies, the protocol in this document depends on the
following helper operations:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">Nonce generation, <a href="#dep-nonces" class="xref">Section 4.1</a><a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">Polynomial operations, <a href="#dep-polynomial" class="xref">Section 4.2</a>;<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">Encoding operations, <a href="#dep-encoding" class="xref">Section 4.3</a>;<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4">Signature binding <a href="#dep-binding-factor" class="xref">Section 4.4</a>, group commitment <a href="#dep-group-commit" class="xref">Section 4.5</a>, and challenge computation <a href="#dep-sig-challenge" class="xref">Section 4.6</a><a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">These sections describes these operations in more detail.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="dep-nonces">
<section id="section-4.1">
        <h3 id="name-nonce-generation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-nonce-generation" class="section-name selfRef">Nonce generation</a>
        </h3>
<p id="section-4.1-1">To hedge against a bad RNG that outputs predictable values, we generate
nonces by sourcing fresh randomness and combine with the secret key,
to create a domain-separated hash function from the ciphersuite hash
function <code>H</code>, <code>H3</code>:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  nonce_generate(secret):

  Inputs:
  - secret, a Scalar

  Outputs: nonce, a Scalar

  def nonce_generate(secret):
    k_enc = random_bytes(32)
    secret_enc = G.SerializeScalar(secret)
    return H3(k_enc || secret_enc)
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-polynomial">
<section id="section-4.2">
        <h3 id="name-polynomial-operations">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-polynomial-operations" class="section-name selfRef">Polynomial Operations</a>
        </h3>
<p id="section-4.2-1">This section describes operations on and associated with polynomials over Scalars
that are used in the main signing protocol. A polynomial of maximum degree t
is represented as a list of t coefficients, where the constant term of the polynomial
is in the first position and the highest-degree coefficient is in the last position.
A point on the polynomial is a tuple (x, y), where <code>y = f(x)</code>. For notational
convenience, we refer to the x-coordinate and y-coordinate of a
point p as <code>p.x</code> and <code>p.y</code>, respectively.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="evaluation-of-a-polynomial">
<section id="section-4.2.1">
          <h4 id="name-evaluation-of-a-polynomial">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-evaluation-of-a-polynomial" class="section-name selfRef">Evaluation of a polynomial</a>
          </h4>
<p id="section-4.2.1-1">This section describes a method for evaluating a polynomial <code>f</code> at a
particular input <code>x</code>, i.e., <code>y = f(x)</code> using Horner's method.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
  polynomial_evaluate(x, coeffs):

  Inputs:
  - x, input at which to evaluate the polynomial, a Scalar
  - coeffs, the polynomial coefficients, a list of Scalars

  Outputs: Scalar result of the polynomial evaluated at input x

  def polynomial_evaluate(x, coeffs):
    value = 0
    for coeff in reverse(coeffs):
      value *= x
      value += coeff
    return value
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="lagrange-coefficients">
<section id="section-4.2.2">
          <h4 id="name-lagrange-coefficients">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-lagrange-coefficients" class="section-name selfRef">Lagrange coefficients</a>
          </h4>
<p id="section-4.2.2-1">The function <code>derive_lagrange_coefficient</code> derives a Lagrange coefficient
to later perform polynomial interpolation, and is provided a list of x-coordinates
as input. Note that <code>derive_lagrange_coefficient</code> does not permit any x-coordinate
to equal 0. Lagrange coefficients are used in FROST to evaluate a polynomial <code>f</code>
at x-coordinate 0, i.e., <code>f(0)</code>, given a list of <code>t</code> other x-coordinates.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-2">
<pre>
  derive_lagrange_coefficient(x_i, L):

  Inputs:
  - x_i, an x-coordinate contained in L, a Scalar
  - L, the set of x-coordinates, each a Scalar

  Outputs: L_i, the i-th Lagrange coefficient

  Errors:
  - "invalid parameters", if any x-coordinate is equal to 0 or if x_i
    is not in L

  def derive_lagrange_coefficient(x_i, L):
    if x_i == 0:
      raise "invalid parameters"
    for x_j in L:
      if x_j == 0:
        raise "invalid parameters"
    if x_i not in L:
      raise "invalid parameters"

    numerator = Scalar(1)
    denominator = Scalar(1)
    for x_j in L:
      if x_j == x_i: continue
      numerator *= x_j
      denominator *= x_j - x_i

    L_i = numerator / denominator
    return L_i
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deriving-the-constant-term-of-a-polynomial">
<section id="section-4.2.3">
          <h4 id="name-deriving-the-constant-term-">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-deriving-the-constant-term-" class="section-name selfRef">Deriving the constant term of a polynomial</a>
          </h4>
<p id="section-4.2.3-1">Secret sharing requires "splitting" a secret, which is represented as
a constant term of some polynomial <code>f</code> of degree <code>t-1</code>. Recovering the
constant term occurs with a set of <code>t</code> points using polynomial
interpolation, defined as follows.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-2">
<pre>
  Inputs:
  - points, a set of t points on a polynomial f, each a tuple of two
    Scalar values representing the x and y coordinates

  Outputs: The constant term of f, i.e., f(0)

  def polynomial_interpolation(points):
    L = []
    for point in points:
      L.append(point.x)

    f_zero = Scalar(0)
    for point in points:
      delta = point.y * derive_lagrange_coefficient(point.x, L)
      f_zero = f_zero + delta

    return f_zero
</pre><a href="#section-4.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="dep-encoding">
<section id="section-4.3">
        <h3 id="name-list-operations">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-list-operations" class="section-name selfRef">List Operations</a>
        </h3>
<p id="section-4.3-1">This section describes helper functions that work on lists of values produced
during the FROST protocol. The following function encodes a list of signer
commitments into a bytestring for use in the FROST protocol.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
  Inputs:
  - commitment_list = [(i, hiding_nonce_commitment_i, binding_nonce_commitment_i), ...],
    a list of commitments issued by each signer, where each element in the list
    indicates the signer identifier i and their two commitment Element values
    (hiding_nonce_commitment_i, binding_nonce_commitment_i). This list MUST be sorted
    in ascending order by signer identifier.

  Outputs: A byte string containing the serialized representation of commitment_list

  def encode_group_commitment_list(commitment_list):
    encoded_group_commitment = nil
    for (identifier, hiding_nonce_commitment, binding_nonce_commitment) in commitment_list:
      encoded_commitment = encode_uint16(identifier) ||
                           G.SerializeElement(hiding_nonce_commitment) ||
                           G.SerializeElement(binding_nonce_commitment)
      encoded_group_commitment = encoded_group_commitment || encoded_commitment
    return encoded_group_commitment
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3-3">The following function is used to extract participant identifiers from a commitment
list.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-4">
<pre>
  Inputs:
  - commitment_list = [(i, hiding_nonce_commitment_i, binding_nonce_commitment_i), ...],
    a list of commitments issued by each signer, where each element in the list
    indicates the signer identifier i and their two commitment Element values
    (hiding_nonce_commitment_i, binding_nonce_commitment_i). This list MUST be sorted
    in ascending order by signer identifier.

  Outputs: A list of signer participant identifiers

def participants_from_commitment_list(commitment_list):
  identifiers = []
  for (identifier, _, _) in commitment_list:
    identifiers.append(identifier)
  return identifiers
</pre><a href="#section-4.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3-5">The following function is used to extract a binding factor from a list of binding factors.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-6">
<pre>
  Inputs:
  - binding_factor_list = [(i, binding_factor), ...],
    a list of binding factors for each signer, where each element in the list
    indicates the signer identifier i and their binding factor. This list MUST be sorted
    in ascending order by signer identifier.
  - identifier, Identifier i of the signer.

  Outputs: A Scalar value.

  Errors: "invalid participant", when the designated participant is not known

def binding_factor_for_participant(binding_factor_list, identifier):
  binding_factors = []
  for (i, binding_factor) in commitment_list:
    if identifier == i:
      return binding_factor
  raise "invalid participant"
</pre><a href="#section-4.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-binding-factor">
<section id="section-4.4">
        <h3 id="name-binding-factors-computation">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-binding-factors-computation" class="section-name selfRef">Binding Factors Computation</a>
        </h3>
<p id="section-4.4-1">This section describes the subroutine for computing binding factors based
on the signer commitment list and message to be signed.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-2">
<pre>
  Inputs:
  - commitment_list = [(i, hiding_nonce_commitment_i, binding_nonce_commitment_i), ...],
    a list of commitments issued by each signer, where each element in the list
    indicates the signer identifier i and their two commitment Element values
    (hiding_nonce_commitment_i, binding_nonce_commitment_i). This list MUST be sorted
    in ascending order by signer identifier.
  - msg, the message to be signed.

  Outputs: A list of (identifier, Scalar) tuples representing the binding factors.

  def compute_binding_factors(commitment_list, msg):
    msg_hash = H4(msg)
    encoded_commitment_hash = H5(encode_group_commitment_list(commitment_list))
    rho_input_prefix = msg_hash || encoded_commitment_hash

    binding_factor_list = []
    for (identifier, hiding_nonce_commitment, binding_nonce_commitment) in commitment_list:
      rho_input = rho_input_prefix || encode_uint16(identifier)
      binding_factor = H1(rho_input)
      binding_factor_list.append((identifier, binding_factor))
    return binding_factor_list
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-group-commit">
<section id="section-4.5">
        <h3 id="name-group-commitment-computatio">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-group-commitment-computatio" class="section-name selfRef">Group Commitment Computation</a>
        </h3>
<p id="section-4.5-1">This section describes the subroutine for creating the group commitment
from a commitment list.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
  Inputs:
  - commitment_list =
     [(i, hiding_nonce_commitment_i, binding_nonce_commitment_i), ...], a list
    of commitments issued by each signer, where each element in the list
    indicates the signer identifier i and their two commitment Element values
    (hiding_nonce_commitment_i, binding_nonce_commitment_i). This list MUST be
    sorted in ascending order by signer identifier.
  - binding_factor_list = [(i, binding_factor), ...],
    a list of (identifier, Scalar) tuples representing the binding factor Scalar
    for the given identifier. This list MUST be sorted in ascending order by identifier.

  Outputs: An Element in G representing the group commitment

  def compute_group_commitment(commitment_list, binding_factor_list):
    group_commitment = G.Identity()
    for (identifier, hiding_nonce_commitment, binding_nonce_commitment) in commitment_list:
      binding_factor = binding_factor_for_participant(binding_factors, identifier)
      group_commitment = group_commitment +
        hiding_nonce_commitment + G.ScalarMult(binding_nonce_commitment, binding_factor)
    return group_commitment
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-sig-challenge">
<section id="section-4.6">
        <h3 id="name-signature-challenge-computa">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-signature-challenge-computa" class="section-name selfRef">Signature Challenge Computation</a>
        </h3>
<p id="section-4.6-1">This section describes the subroutine for creating the per-message challenge.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-2">
<pre>
  Inputs:
  - group_commitment, an Element in G representing the group commitment
  - group_public_key, public key corresponding to the group signing key, an
    Element in G.
  - msg, the message to be signed.

  Outputs: A Scalar representing the challenge

  def compute_challenge(group_commitment, group_public_key, msg):
    group_comm_enc = G.SerializeElement(group_commitment)
    group_public_key_enc = G.SerializeElement(group_public_key)
    challenge_input = group_comm_enc || group_public_key_enc || msg
    challenge = H2(challenge_input)
    return challenge
</pre><a href="#section-4.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="frost-spec">
<section id="section-5">
      <h2 id="name-two-round-frost-signing-pro">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-two-round-frost-signing-pro" class="section-name selfRef">Two-Round FROST Signing Protocol</a>
      </h2>
<p id="section-5-1">We now present the two-round variant of the FROST threshold signature protocol for producing Schnorr signatures.
It involves signer participants and a Coordinator. Signer participants are
entities with signing key shares that participate in the threshold signing
protocol. The Coordinator is an entity with the following responsibilities:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-2">
<li id="section-5-2.1">Determining which signers will participate (at least MIN_SIGNERS in number);<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.2">Coordinating rounds (receiving and forwarding inputs among participants); and<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.3">Aggregating signature shares output by each participant, and publishing the resulting signature.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-3">FROST assumes the selection of all participants, including Coordinator and set of
signers, are all chosen external to the protocol. Note that it is possible to
deploy the protocol without a distinguished Coordinator; see <a href="#no-coordinator" class="xref">Section 7.3</a>
for more information.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Because key generation is not specified, all signers are assumed to have the
(public) group state that we refer to as "group info" below, and their corresponding
signing key shares.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">In particular, it is assumed that the Coordinator and each signer participant <code>P_i</code> knows the following
group info:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-6.1">Group public key, an <code>Element</code> in <code>G</code>, denoted <code>PK</code>, corresponding
to the group secret key <code>s</code>, which is a <code>Scalar</code>. <code>PK</code> is an output from the
group's key generation protocol, such as <code>trusted_dealer_keygen</code> or a DKG.<a href="#section-5-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-6.2">Public keys for each signer, denoted <code>PK_i</code>, which are similarly outputs
from the group's key generation protocol, <code>Element</code> values in <code>G</code>.<a href="#section-5-6.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-7">And that each participant with identifier <code>i</code> additionally knows the following:<a href="#section-5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-8.1">Participant <code>i</code>s signing key share <code>sk_i</code>, which is the i-th secret share of <code>s</code>, a <code>Scalar</code>.<a href="#section-5-8.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-9">By construction, <code>PK = G.ScalarBaseMult(s)</code> and <code>PK_i = G.ScalarMultBase(sk_i)</code> for each participant <code>i</code>.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">The exact key generation mechanism is out of scope for this specification. In general,
key generation is a protocol that outputs (1) a shared, group public key PK owned
by each Signer, and (2) individual shares of the signing key owned by each Signer.
In general, two possible key generation mechanisms are possible, one that requires
a single, trusted dealer, and the other which requires performing a distributed
key generation protocol. We highlight key generation mechanism by a trusted dealer
in <a href="#dep-dealer" class="xref">Appendix C</a>, for reference.<a href="#section-5-10" class="pilcrow">¶</a></p>
<p id="section-5-11">This signing variant of FROST requires signers to perform two network rounds:
1) generating and publishing commitments, and 2) signature share generation and
publication. The first round serves for each participant to issue a commitment to
a nonce. The second round receives commitments for all signers as well as the message,
and issues a signature share with respect to that message. The Coordinator performs
the coordination of each of these rounds. At the end of the second round, the
Coordinator then performs an aggregation step and outputs the final signature.
This complete interaction is shown in <a href="#fig-frost" class="xref">Figure 1</a>.<a href="#section-5-11" class="pilcrow">¶</a></p>
<span id="name-frost-signature-overview"></span><div id="fig-frost">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-5-12.1">
<pre>
        (group info)            (group info,     (group info,
            |               signing key share)   signing key share)
            |                         |                |
            v                         v                v
        Coordinator               Signer-1   ...   Signer-n
    ------------------------------------------------------------
   message
------------&gt;
            |
      == Round 1 (Commitment) ==
            |    signer commitment   |                 |
            |&lt;-----------------------+                 |
            |          ...                             |
            |    signer commitment              (commit state) ==\
            |&lt;-----------------------------------------+         |
                                                                 |
      == Round 2 (Signature Share Generation) ==                 |
            |                                                    |
            |     signer input       |                 |         |
            +------------------------&gt;                 |         |
            |     signature share    |                 |         |
            |&lt;-----------------------+                 |         |
            |          ...                             |         |
            |     signer input                         |         |
            +------------------------------------------&gt;         /
            |     signature share                      |&lt;=======/
            &lt;------------------------------------------+
            |
      == Aggregation ==
            |
  signature |
&lt;-----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-frost-signature-overview" class="selfRef">FROST signature overview</a>
        </figcaption></figure>
</div>
<p id="section-5-13">Details for round one are described in <a href="#frost-round-one" class="xref">Section 5.1</a>, and details for round two
are described in <a href="#frost-round-two" class="xref">Section 5.2</a>. Note that each signer persists some state between
both rounds, and this state is deleted as described in <a href="#frost-round-two" class="xref">Section 5.2</a>. The final
Aggregation step is described in <a href="#frost-aggregation" class="xref">Section 5.3</a>.<a href="#section-5-13" class="pilcrow">¶</a></p>
<p id="section-5-14">FROST assumes that all inputs to each round, especially those of which are received
over the network, are validated before use. In particular, this means that any value
of type Element or Scalar is deserialized using DeserializeElement and DeserializeScalar,
respectively, as these functions perform the necessary input validation steps.<a href="#section-5-14" class="pilcrow">¶</a></p>
<p id="section-5-15">FROST assumes reliable message delivery between the Coordinator and signer participants in
order for the protocol to complete. An attacker masquerading as another participant
will result only in an invalid signature; see <a href="#sec-considerations" class="xref">Section 7</a>. However, in order
to identify any participant which has misbehaved (resulting in the protocol aborting)
to take actions such as excluding them from future signing operations, we assume that
the network channel is additionally authenticated; confidentiality is not required.<a href="#section-5-15" class="pilcrow">¶</a></p>
<div id="frost-round-one">
<section id="section-5.1">
        <h3 id="name-round-one-commitment">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-round-one-commitment" class="section-name selfRef">Round One - Commitment</a>
        </h3>
<p id="section-5.1-1">Round one involves each signer generating nonces and their corresponding public commitments.
A nonce is a pair of Scalar values, and a commitment is a pair of Element values.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Each signer in round one generates a nonce <code>nonce = (hiding_nonce, binding_nonce)</code> and commitment
<code>comm = (hiding_nonce_commitment, binding_nonce_commitment)</code>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
  Inputs: sk_i, the secret key share, a Scalar

  Outputs: (nonce, comm), a tuple of nonce and nonce commitment pairs,
    where each value in the nonce pair is a Scalar and each value in
    the nonce commitment pair is an Element

  def commit(sk_i):
    hiding_nonce = nonce_generate(sk_i)
    binding_nonce = nonce_generate(sk_i)
    hiding_nonce_commitment = G.ScalarBaseMult(hiding_nonce)
    binding_nonce_commitment = G.ScalarBaseMult(binding_nonce)
    nonce = (hiding_nonce, binding_nonce)
    comm = (hiding_nonce_commitment, binding_nonce_commitment)
    return (nonce, comm)
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">The private output <code>nonce</code> from Participant <code>P_i</code> is stored locally and kept private
for use in the second round. This nonce MUST NOT be reused in more than one invocation
of FROST, and it MUST be generated from a source of secure randomness. The public output
<code>comm</code> from Participant <code>P_i</code> is sent to the Coordinator.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frost-round-two">
<section id="section-5.2">
        <h3 id="name-round-two-signature-share-g">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-round-two-signature-share-g" class="section-name selfRef">Round Two - Signature Share Generation</a>
        </h3>
<p id="section-5.2-1">In round two, the Coordinator is responsible for sending the message to be signed, and
for choosing which signers will participate (of number at least MIN_SIGNERS). Signers
additionally require locally held data; specifically, their private key and the
nonces corresponding to their commitment issued in round one.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The Coordinator begins by sending each signer the message to be signed along with the
set of signing commitments for all signers in the participant list. Each signer
MUST validate the inputs before processing the Coordinator's request. In particular,
the Signer MUST validate commitment_list, deserializing each group Element in the
list using DeserializeElement from <a href="#dep-pog" class="xref">Section 3.1</a>. If deserialization fails, the Signer
MUST abort the protocol. Moreover, each signer MUST ensure that their identifier as well as their commitment as from the first round appears in commitment_list.
Applications which require that signers not process arbitrary
input messages are also required to also perform relevant application-layer input
validation checks; see <a href="#message-validation" class="xref">Section 7.4</a> for more details.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Upon receipt and successful input validation, each Signer then runs the following
procedure to produce its own signature share.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
  Inputs:
  - identifier, Identifier i of the signer. Note identifier will never equal 0.
  - sk_i, Signer secret key share, a Scalar.
  - group_public_key, public key corresponding to the group signing key,
    an Element in G.
  - nonce_i, pair of Scalar values (hiding_nonce, binding_nonce) generated in
    round one.
  - msg, the message to be signed (sent by the Coordinator).
  - commitment_list =
      [(j, hiding_nonce_commitment_j, binding_nonce_commitment_j), ...], a
    list of commitments issued in Round 1 by each signer and sent by the Coordinator.
    Each element in the list indicates the signer identifier j and their two commitment
    Element values (hiding_nonce_commitment_j, binding_nonce_commitment_j).
    This list MUST be sorted in ascending order by signer identifier.

  Outputs: a Scalar value representing the signature share

  def sign(identifier, sk_i, group_public_key, nonce_i, msg, commitment_list):
    # Compute the binding factor(s)
    binding_factor_list = compute_binding_factors(commitment_list, msg)
    binding_factor = binding_factor_for_participant(binding_factor_list, identifier)

    # Compute the group commitment
    group_commitment = compute_group_commitment(commitment_list, binding_factor_list)

    # Compute Lagrange coefficient
    participant_list = participants_from_commitment_list(commitment_list)
    lambda_i = derive_lagrange_coefficient(Scalar(identifier), participant_list)

    # Compute the per-message challenge
    challenge = compute_challenge(group_commitment, group_public_key, msg)

    # Compute the signature share
    (hiding_nonce, binding_nonce) = nonce_i
    sig_share = hiding_nonce + (binding_nonce * binding_factor) + (lambda_i * sk_i * challenge)

    return sig_share
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2-5">The output of this procedure is a signature share. Each signer then sends
these shares back to the Coordinator. Each signer MUST delete the nonce and
corresponding commitment after this round completes, and MUST use the nonce
to generate at most one signature share.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">Note that the <code>lambda_i</code> value derived during this procedure does not change
across FROST signing operations for the same signing group. As such, signers
can compute it once and store it for reuse across signing sessions.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">Upon receipt from each Signer, the Coordinator MUST validate the input
signature share using DeserializeElement. If validation fails, the Coordinator MUST abort
the protocol. If validation succeeds, the Coordinator then verifies the set of
signature shares using the following procedure.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frost-aggregation">
<section id="section-5.3">
        <h3 id="name-signature-share-verificatio">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-signature-share-verificatio" class="section-name selfRef">Signature Share Verification and Aggregation</a>
        </h3>
<p id="section-5.3-1">After signers perform round two and send their signature shares to the Coordinator,
the Coordinator verifies each signature share for correctness. In particular,
for each signer, the Coordinator uses commitment pairs generated during round
one and the signature share generated during round two, along with other group
parameters, to check that the signature share is valid using the following procedure.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-2">
<pre>
  Inputs:
  - identifier, Identifier i of the signer. Note: identifier MUST never equal 0.
  - PK_i, the public key for the ith signer, where PK_i = G.ScalarBaseMult(sk_i),
    an Element in G
  - comm_i, pair of Element values in G (hiding_nonce_commitment, binding_nonce_commitment)
    generated in round one from the ith signer.
  - sig_share_i, a Scalar value indicating the signature share as produced in
    round two from the ith signer.
  - commitment_list =
      [(j, hiding_nonce_commitment_j, binding_nonce_commitment_j), ...], a
    list of commitments issued in Round 1 by each signer, where each element
    in the list indicates the signer identifier j and their two commitment
    Element values (hiding_nonce_commitment_j, binding_nonce_commitment_j).
    This list MUST be sorted in ascending order by signer identifier.
  - group_public_key, public key corresponding to the group signing key,
    an Element in G.
  - msg, the message to be signed.

  Outputs: True if the signature share is valid, and False otherwise.

  def verify_signature_share(identifier, PK_i, comm_i, sig_share_i, commitment_list,
                             group_public_key, msg):
    # Compute the binding factors
    binding_factor_list = compute_binding_factors(commitment_list, msg)
    binding_factor = binding_factor_for_participant(binding_factor_list, identifier)

    # Compute the group commitment
    group_commitment = compute_group_commitment(commitment_list, binding_factor_list)

    # Compute the commitment share
    (hiding_nonce_commitment, binding_nonce_commitment) = comm_i
    comm_share = hiding_nonce_commitment + G.ScalarMult(binding_nonce_commitment, binding_factor)

    # Compute the challenge
    challenge = compute_challenge(group_commitment, group_public_key, msg)

    # Compute Lagrange coefficient
    participant_list = participants_from_commitment_list(commitment_list)
    lambda_i = derive_lagrange_coefficient(Scalar(identifier), participant_list)

    # Compute relation values
    l = G.ScalarBaseMult(sig_share_i)
    r = comm_share + G.ScalarMult(PK_i, challenge * lambda_i)

    return l == r
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">If any signature share fails to verify, i.e., if verify_signature_share returns False for
any signer share, the Coordinator MUST abort the protocol for correctness reasons.
Excluding one signer means that their nonce will not be included in the joint response <code>z</code>
and consequently the output signature will not verify.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">Otherwise, if all shares from signers that participated in Rounds 1 and 2 are valid, the Coordinator
performs the <code>aggregate</code> operation and publishes the resulting signature.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-5">
<pre>
  Inputs:
  - group_commitment, the group commitment returned by compute_group_commitment,
    an Element in G.
  - sig_shares, a set of signature shares z_i, Scalar values, for each signer,
    of length NUM_SIGNERS, where MIN_SIGNERS &lt;= NUM_SIGNERS &lt;= MAX_SIGNERS.

  Outputs: (R, z), a Schnorr signature consisting of an Element R and Scalar z.

  def aggregate(group_commitment, sig_shares):
    z = 0
    for z_i in sig_shares:
      z = z + z_i
    return (group_commitment, z)
</pre><a href="#section-5.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.3-6">The output signature (R, z) from the aggregation step MUST be encoded as follows
(using notation from <span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#TLS" class="xref">TLS</a>]</span>):<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-7">
<pre>
  struct {
    opaque R_encoded[Ne];
    opaque z_encoded[Ns];
  } Signature;
</pre><a href="#section-5.3-7" class="pilcrow">¶</a>
</div>
<p id="section-5.3-8">Where Signature.R_encoded is <code>G.SerializeElement(R)</code> and Signature.z_encoded is
<code>G.SerializeScalar(z)</code>.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-6">
      <h2 id="name-ciphersuites">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-6-1">A FROST ciphersuite must specify the underlying prime-order group details
and cryptographic hash function. Each ciphersuite is denoted as (Group, Hash),
e.g., (ristretto255, SHA-512). This section contains some ciphersuites.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The RECOMMENDED ciphersuite is (ristretto255, SHA-512) <a href="#recommended-suite" class="xref">Section 6.2</a>.
The (Ed25519, SHA-512) ciphersuite is included for backwards compatibility
with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The DeserializeElement and DeserializeScalar functions instantiated for a
particular prime-order group corresponding to a ciphersuite MUST adhere
to the description in <a href="#dep-pog" class="xref">Section 3.1</a>. Validation steps for these functions
are described for each the ciphersuites below. Future ciphersuites MUST
describe how input validation is done for DeserializeElement and DeserializeScalar.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Each ciphersuite includes explicit instructions for verifying signatures produced
by FROST. Note that these instructions are equivalent to those produced by a single
signer.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="frosted25519-sha-512">
<section id="section-6.1">
        <h3 id="name-frosted25519-sha-512">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-frosted25519-sha-512" class="section-name selfRef">FROST(Ed25519, SHA-512)</a>
        </h3>
<p id="section-6.1-1">This ciphersuite uses edwards25519 for the Group and SHA-512 for the Hash function <code>H</code>
meant to produce signatures indistinguishable from Ed25519 as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
The value of the contextString parameter is "FROST-ED25519-SHA512-v8".<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">Group: edwards25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1.2.1">Order(): Return 2^252 + 27742317777372353535851937790883648493 (see <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>)<a href="#section-6.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.2">Identity(): As defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-6.1-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.3">RandomScalar(): Implemented by returning a uniformly random Scalar in the range
[0, <code>G.Order()</code> - 1]. Refer to <a href="#random-scalar" class="xref">Appendix D</a> for implementation guidance.<a href="#section-6.1-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.4">SerializeElement(A): Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.2" class="relref">Section 5.1.2</a></span>.<a href="#section-6.1-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.5">DeserializeElement(buf): Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.3" class="relref">Section 5.1.3</a></span>.
Additionally, this function validates that the resulting element is not the group
identity element and is in the prime-order subgroup. The latter check can
be implemented by multiplying the resulting point by the order of the group and
checking that the result is the identity element.<a href="#section-6.1-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.6">SerializeScalar(s): Implemented by outputting the little-endian 32-byte encoding of
the Scalar value.<a href="#section-6.1-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.7">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
little-endian 32-byte string. This function can fail if the input does not
represent a Scalar in the range [0, <code>G.Order()</code> - 1].<a href="#section-6.1-2.1.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">Hash (<code>H</code>): SHA-512, and Nh = 64.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.2.2.1">H1(m): Implemented by computing H(contextString || "rho" || m), interpreting the 64-byte digest
as a little-endian integer, and reducing the resulting integer modulo
L = 2^252+27742317777372353535851937790883648493.<a href="#section-6.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.2.2.2">H2(m): Implemented by computing H(m), interpreting the 64-byte digest
as a little-endian integer, and reducing the resulting integer modulo
L = 2^252+27742317777372353535851937790883648493.<a href="#section-6.1-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.2.2.3">H3(m): Implemented by computing H(contextString || "nonce" || m), interpreting the 64-byte digest
as a little-endian integer, and reducing the resulting integer modulo
L = 2^252+27742317777372353535851937790883648493.<a href="#section-6.1-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.2.2.4">H4(m): Implemented by computing H(contextString || "msg" || m).<a href="#section-6.1-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.2.2.5">H5(m): Implemented by computing H(contextString || "com" || m).<a href="#section-6.1-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.1-3">Normally H2 would also include a domain separator, but for backwards compatibility
with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, it is omitted.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Signature verification is as specified in <span><a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.7" class="relref">Section 5.1.7</a> of [<a href="#RFC8032" class="xref">RFC8032</a>]</span> with the
constraint that implementations MUST check the group equation [8][S]B = [8]R + [8][k]A'.
The alternative check [S]B = R + [k]A' is not safe or interoperable in practice.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recommended-suite">
<section id="section-6.2">
        <h3 id="name-frostristretto255-sha-512">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-frostristretto255-sha-512" class="section-name selfRef">FROST(ristretto255, SHA-512)</a>
        </h3>
<p id="section-6.2-1">This ciphersuite uses ristretto255 for the Group and SHA-512 for the Hash function <code>H</code>.
The value of the contextString parameter is "FROST-RISTRETTO255-SHA512-v8".<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">Group: ristretto255 <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span><a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1.2.1">Order(): Return 2^252 + 27742317777372353535851937790883648493 (see <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>)<a href="#section-6.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.2">Identity(): As defined in <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-6.2-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.3">RandomScalar(): Implemented by returning a uniformly random Scalar in the range
[0, <code>G.Order()</code> - 1]. Refer to <a href="#random-scalar" class="xref">Appendix D</a> for implementation guidance.<a href="#section-6.2-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.4">SerializeElement(A): Implemented using the 'Encode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-6.2-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.5">DeserializeElement(buf): Implemented using the 'Decode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-6.2-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.6">SerializeScalar(s): Implemented by outputting the little-endian 32-byte encoding of
the Scalar value.<a href="#section-6.2-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.7">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
little-endian 32-byte string. This function can fail if the input does not
represent a Scalar in the range [0, <code>G.Order()</code> - 1].<a href="#section-6.2-2.1.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">Hash (<code>H</code>): SHA-512, and Nh = 64.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.2.2.1">H1(m): Implemented by computing H(contextString || "rho" || m) and mapping the
output to a Scalar as described in <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-6.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.2">H2(m): Implemented by computing H(contextString || "chal" || m) and mapping the
output to a Scalar as described in <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-6.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.3">H3(m): Implemented by computing H(contextString || "nonce" || m) and mapping the
output to a Scalar as described in <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-6.2-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.4">H4(m): Implemented by computing H(contextString || "msg" || m).<a href="#section-6.2-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.5">H5(m): Implemented by computing H(contextString || "com" || m).<a href="#section-6.2-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.2-3">Signature verification is as specified in <a href="#prime-order-verify" class="xref">Appendix B</a>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frosted448-shake256">
<section id="section-6.3">
        <h3 id="name-frosted448-shake256">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-frosted448-shake256" class="section-name selfRef">FROST(Ed448, SHAKE256)</a>
        </h3>
<p id="section-6.3-1">This ciphersuite uses edwards448 for the Group and SHAKE256 for the Hash function <code>H</code>
meant to produce signatures indistinguishable from Ed448 as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
The value of the contextString parameter is "FROST-ED448-SHAKE256-v8".<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">
            <p id="section-6.3-2.1.1">Group: edwards448 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1.2.1">Order(): Return 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885<a href="#section-6.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.2">Identity(): As defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-6.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.3">RandomScalar(): Implemented by returning a uniformly random Scalar in the range
[0, <code>G.Order()</code> - 1]. Refer to <a href="#random-scalar" class="xref">Appendix D</a> for implementation guidance.<a href="#section-6.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.4">SerializeElement(A): Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.2.2" class="relref">Section 5.2.2</a></span>.<a href="#section-6.3-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.5">DeserializeElement(buf): Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.2.3" class="relref">Section 5.2.3</a></span>.
Additionally, this function validates that the resulting element is not the group
identity element.<a href="#section-6.3-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.6">SerializeScalar(s): Implemented by outputting the little-endian 48-byte encoding of
the Scalar value.<a href="#section-6.3-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.7">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a
little-endian 48-byte string. This function can fail if the input does not
represent a Scalar in the range [0, <code>G.Order()</code> - 1].<a href="#section-6.3-2.1.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">Hash (<code>H</code>): SHAKE256, and Nh = 114.<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.2.2.1">H1(m): Implemented by computing H(contextString || "rho" || m), interpreting the
114-byte digest as a little-endian integer, and reducing the resulting integer modulo
L = 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885.<a href="#section-6.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.2">H2(m): Implemented by computing H("SigEd448" || 0 || 0 || m), interpreting
the 114-byte digest as a little-endian integer, and reducing the resulting integer
modulo L = 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885.<a href="#section-6.3-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.3">H3(m): Implemented by computing H(contextString || "nonce" || m), interpreting the
114-byte digest as a little-endian integer, and reducing the resulting integer modulo
L = 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885.<a href="#section-6.3-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.4">H4(m): Implemented by computing H(contextString || "msg" || m).<a href="#section-6.3-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.5">H5(m): Implemented by computing H(contextString || "com" || m).<a href="#section-6.3-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.3-3">Normally H2 would also include a domain separator, but for backwards compatibility
with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, it is omitted.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">Signature verification is as specified in <span><a href="https://rfc-editor.org/rfc/rfc8032#section-5.2.7" class="relref">Section 5.2.7</a> of [<a href="#RFC8032" class="xref">RFC8032</a>]</span> with the
constraint that implementations MUST check the group equation [4][S]B = [4]R + [4][k]A'.
The alternative check [S]B = R + [k]A' is not safe or interoperable in practice.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frostp-256-sha-256">
<section id="section-6.4">
        <h3 id="name-frostp-256-sha-256">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-frostp-256-sha-256" class="section-name selfRef">FROST(P-256, SHA-256)</a>
        </h3>
<p id="section-6.4-1">This ciphersuite uses P-256 for the Group and SHA-256 for the Hash function <code>H</code>.
The value of the contextString parameter is "FROST-P256-SHA256-v8".<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
            <p id="section-6.4-2.1.1">Group: P-256 (secp256r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-6.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1.2.1">Order(): Return 0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551<a href="#section-6.4-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.2">Identity(): As defined in <span>[<a href="#x9.62" class="xref">x9.62</a>]</span>.<a href="#section-6.4-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.3">RandomScalar(): Implemented by returning a uniformly random Scalar in the range
[0, <code>G.Order()</code> - 1]. Refer to <a href="#random-scalar" class="xref">Appendix D</a> for implementation guidance.<a href="#section-6.4-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.4">SerializeElement(A): Implemented using the compressed Elliptic-Curve-Point-to-Octet-String
method according to <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>.<a href="#section-6.4-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.5">DeserializeElement(buf): Implemented by attempting to deserialize a public key using
the compressed Octet-String-to-Elliptic-Curve-Point method according to <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>,
and then performs partial public-key validation as defined in section 5.6.2.3.4 of
<span>[<a href="#KEYAGREEMENT" class="xref">KEYAGREEMENT</a>]</span>. This includes checking that the
coordinates of the resulting point are in the correct range, that the point is on
the curve, and that the point is not the point at infinity. Additionally, this function
validates that the resulting element is not the group identity element.
If these checks fail, deserialization returns an error.<a href="#section-6.4-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.6">SerializeScalar(s): Implemented using the Field-Element-to-Octet-String conversion
according to <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>.<a href="#section-6.4-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.7">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a 32-byte
string using Octet-String-to-Field-Element from <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. This function can fail if the
input does not represent a Scalar in the range [0, <code>G.Order()</code> - 1].<a href="#section-6.4-2.1.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.4-2.2">
            <p id="section-6.4-2.2.1">Hash (<code>H</code>): SHA-256, and Nh = 32.<a href="#section-6.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.2.2.1">H1(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "rho", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.4-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.2.2.2">H2(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "chal", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.4-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.2.2.3">H3(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "nonce", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.4-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.2.2.4">H4(m): Implemented by computing H(contextString || "msg" || m).<a href="#section-6.4-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.2.2.5">H5(m): Implemented by computing H(contextString || "com" || m).<a href="#section-6.4-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.4-3">Signature verification is as specified in <a href="#prime-order-verify" class="xref">Appendix B</a>.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frostsecp256k1-sha-256">
<section id="section-6.5">
        <h3 id="name-frostsecp256k1-sha-256">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-frostsecp256k1-sha-256" class="section-name selfRef">FROST(secp256k1, SHA-256)</a>
        </h3>
<p id="section-6.5-1">This ciphersuite uses secp256k1 for the Group and SHA-256 for the Hash function <code>H</code>.
The value of the contextString parameter is "FROST-secp256k1-SHA256-v8".<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-2.1">
            <p id="section-6.5-2.1.1">Group: secp256k1 <span>[<a href="#SEC2" class="xref">SEC2</a>]</span><a href="#section-6.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-2.1.2.1">Order(): Return 0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551<a href="#section-6.5-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.1.2.2">Identity(): As defined in <span>[<a href="#SEC2" class="xref">SEC2</a>]</span>.<a href="#section-6.5-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.1.2.3">RandomScalar(): Implemented by returning a uniformly random Scalar in the range
[0, <code>G.Order()</code> - 1]. Refer to <a href="#random-scalar" class="xref">Appendix D</a> for implementation guidance.<a href="#section-6.5-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.1.2.4">SerializeElement(A): Implemented using the compressed Elliptic-Curve-Point-to-Octet-String
method according to <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>.<a href="#section-6.5-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.1.2.5">DeserializeElement(buf): Implemented by attempting to deserialize a public key using
the compressed Octet-String-to-Elliptic-Curve-Point method according to <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>,
and then performs partial public-key validation as defined in section 3.2.2.1 of
<span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. This includes checking that the coordinates of the resulting point are
in the correct range, that the point is on the curve, and that the point is not
the point at infinity. Additionally, this function validates that the resulting
element is not the group identity element. If these checks fail, deserialization
returns an error.<a href="#section-6.5-2.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.1.2.6">SerializeScalar(s): Implemented using the Field-Element-to-Octet-String conversion
according to <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>.<a href="#section-6.5-2.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.1.2.7">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a 32-byte
string using Octet-String-to-Field-Element from <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. This function can fail if the
input does not represent a Scalar in the range [0, <code>G.Order()</code> - 1].<a href="#section-6.5-2.1.2.7" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.5-2.2">
            <p id="section-6.5-2.2.1">Hash (<code>H</code>): SHA-256, and Nh = 32.<a href="#section-6.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-2.2.2.1">H1(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "rho", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.5-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.2.2.2">H2(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "chal", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.5-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.2.2.3">H3(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "nonce", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.5-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.2.2.4">H4(m): Implemented by computing H(contextString || "msg" || m).<a href="#section-6.5-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.5-2.2.2.5">H5(m): Implemented by computing H(contextString || "com" || m).<a href="#section-6.5-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.5-3">Signature verification is as specified in <a href="#prime-order-verify" class="xref">Appendix B</a>.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">A security analysis of FROST exists in <span>[<a href="#FROST20" class="xref">FROST20</a>]</span> and <span>[<a href="#Schnorr21" class="xref">Schnorr21</a>]</span>. The protocol as specified
in this document assumes the following threat model.<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">Trusted dealer. The dealer that performs key generation is trusted to follow
the protocol, although participants still are able to verify the consistency of their
shares via a VSS (verifiable secret sharing) step; see <a href="#dep-vss" class="xref">Appendix C.2</a>.<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">Unforgeability assuming at most <code>(MIN_SIGNERS-1)</code> corrupted signers. So long as an adversary
corrupts fewer than <code>MIN_SIGNERS</code> participants, the scheme remains secure against Existential
Unforgeability Under Chosen Message Attack (EUF-CMA) attacks, as defined in <span>[<a href="#BonehShoup" class="xref">BonehShoup</a>]</span>,
Definition 13.2.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">Coordinator. We assume the Coordinator at the time of signing does not perform a
denial of service attack. A denial of service would include any action which either
prevents the protocol from completing or causing the resulting signature to be invalid.
Such actions for the latter include sending inconsistent values to signer participants,
such as messages or the set of individual commitments. Note that the Coordinator
is <em>not</em> trusted with any private information and communication at the time of signing
can be performed over a public but reliable channel.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-3">The protocol as specified in this document does not target the following goals:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">Post quantum security. FROST, like plain Schnorr signatures, requires the hardness of the Discrete Logarithm Problem.<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.2">Robustness. In the case of failure, FROST requires aborting the protocol.<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.3">Downgrade prevention. All participants in the protocol are assumed to agree on what algorithms to use.<a href="#section-7-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.4">Metadata protection. If protection for metadata is desired, a higher-level communication
channel can be used to facilitate key generation and signing.<a href="#section-7-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-5">The rest of this section documents issues particular to implementations or deployments.<a href="#section-7-5" class="pilcrow">¶</a></p>
<div id="nonce-reuse-attacks">
<section id="section-7.1">
        <h3 id="name-nonce-reuse-attacks">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-nonce-reuse-attacks" class="section-name selfRef">Nonce Reuse Attacks</a>
        </h3>
<p id="section-7.1-1"><a href="#dep-nonces" class="xref">Section 4.1</a> describes the procedure that signers use to produce nonces during
the first round of singing. The randomness produced in this procedure MUST be sampled
uniformly at random. The resulting nonces produced via <code>nonce_generate</code> are indistinguishable
from values sampled uniformly at random. This requirement is necessary to avoid
replay attacks initiated by other signers, which allows for a complete key-recovery attack.
The Coordinator MAY further hedge against nonce reuse attacks by tracking signer nonce
commitments used for a given group key, at the cost of additional state.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-failures">
<section id="section-7.2">
        <h3 id="name-protocol-failures">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-protocol-failures" class="section-name selfRef">Protocol Failures</a>
        </h3>
<p id="section-7.2-1">We do not specify what implementations should do when the protocol fails, other than requiring that
the protocol abort. Examples of viable failure include when a verification check returns invalid or
if the underlying transport failed to deliver the required messages.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-coordinator">
<section id="section-7.3">
        <h3 id="name-removing-the-coordinator-ro">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-removing-the-coordinator-ro" class="section-name selfRef">Removing the Coordinator Role</a>
        </h3>
<p id="section-7.3-1">In some settings, it may be desirable to omit the role of the Coordinator entirely.
Doing so does not change the security implications of FROST, but instead simply
requires each participant to communicate with all other participants. We loosely
describe how to perform FROST signing among signers without this coordinator role.
We assume that every participant receives as input from an external source the
message to be signed prior to performing the protocol.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">Every participant begins by performing <code>commit()</code> as is done in the setting
where a Coordinator is used. However, instead of sending the commitment
to the Coordinator, every participant instead will publish
this commitment to every other participant. Then, in the second round, signers will already have
sufficient information to perform signing. They will directly perform <code>sign</code>.
All participants will then publish their signature shares to one another. After having
received all signature shares from all other signers, each signer will then perform
<code>verify_signature_share</code> and then <code>aggregate</code> directly.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The requirements for the underlying network channel remain the same in the setting
where all participants play the role of the Coordinator, in that all messages that
are exchanged are public and so the channel simply must be reliable. However, in
the setting that a player attempts to split the view of all other players by
sending disjoint values to a subset of players, the signing operation will output
an invalid signature. To avoid this denial of service, implementations may wish
to define a mechanism where messages are authenticated, so that cheating players
can be identified and excluded.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-validation">
<section id="section-7.4">
        <h3 id="name-input-message-validation">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-input-message-validation" class="section-name selfRef">Input Message Validation</a>
        </h3>
<p id="section-7.4-1">Some applications may require that signers only process messages of a certain
structure. For example, in digital currency applications wherein multiple
signers may collectively sign a transaction, it is reasonable to require that
each signer check the input message to be a syntactically valid transaction.
As another example, use of threshold signatures in TLS <span>[<a href="#TLS" class="xref">TLS</a>]</span> to produce
signatures of transcript hashes might require that signers check that the input
message is a valid TLS transcript from which the corresponding transcript hash
can be derived.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">In general, input message validation is an application-specific consideration
that varies based on the use case and threat model. However, it is RECOMMENDED
that applications take additional precautions and validate inputs so that signers
do not operate as signing oracles for arbitrary messages.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-8">
      <h2 id="name-contributors">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-8-1.1">Isis Lovecruft<a href="#section-8-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-1.2">Alden Torres<a href="#section-8-1.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-1.3">T. Wilson-Brown<a href="#section-8-1.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-1.4">Conrado Gouvea<a href="#section-8-1.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="HASH-TO-CURVE">[HASH-TO-CURVE]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KEYAGREEMENT">[KEYAGREEMENT]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for pair-wise key-establishment schemes using discrete logarithm cryptography"</span>, <span class="seriesInfo">National Institute of Standards and Technology report</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-56ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-56ar3">https://doi.org/10.6028/nist.sp.800-56ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RISTRETTO">[RISTRETTO]</dt>
        <dd>
<span class="refAuthor">Valence, H. D.</span>, <span class="refAuthor">Grigg, J.</span>, <span class="refAuthor">Hamburg, M.</span>, <span class="refAuthor">Lovecruft, I.</span>, <span class="refAuthor">Tankersley, G.</span>, and <span class="refAuthor">F. Valsorda</span>, <span class="refTitle">"The ristretto255 and decaf448 Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-ristretto255-decaf448-03</span>, <time datetime="2022-02-25" class="refDate">25 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refTitle">"Elliptic Curve Cryptography, Standards for Efficient Cryptography Group, ver. 2"</span>, <time datetime="2009" class="refDate">2009</time>, <span>&lt;<a href="https://secg.org/sec1-v2.pdf">https://secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
        <dd>
<span class="refTitle">"Recommended Elliptic Curve Domain Parameters, Standards for Efficient Cryptography Group, ver. 2"</span>, <time datetime="2010" class="refDate">2010</time>, <span>&lt;<a href="https://secg.org/sec2-v2.pdf">https://secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="x9.62">[x9.62]</dt>
      <dd>
<span class="refAuthor">ANSI</span>, <span class="refTitle">"Public Key Cryptography for the Financial Services Industry: the Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">ANSI X9.62-1998</span>, <time datetime="1998-09" class="refDate">September 1998</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BonehShoup">[BonehShoup]</dt>
        <dd>
<span class="refAuthor">Boneh, D.</span> and <span class="refAuthor">V. Shoup</span>, <span class="refTitle">"A Graduate Course in Applied Cryptography"</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="http://toc.cryptobook.us/book.pdf">http://toc.cryptobook.us/book.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FROST20">[FROST20]</dt>
        <dd>
<span class="refAuthor">Komlo, C.</span> and <span class="refAuthor">I. Goldberg</span>, <span class="refTitle">"Two-Round Threshold Signatures with FROST"</span>, <time datetime="2020-12-22" class="refDate">22 December 2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/852.pdf">https://eprint.iacr.org/2020/852.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Schnorr21">[Schnorr21]</dt>
        <dd>
<span class="refAuthor">Crites, E.</span>, <span class="refAuthor">Komlo, C.</span>, and <span class="refAuthor">M. Maller</span>, <span class="refTitle">"How to Prove Schnorr Assuming Schnorr"</span>, <time datetime="2021-10-11" class="refDate">11 October 2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/1375">https://eprint.iacr.org/2021/1375</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="StrongerSec22">[StrongerSec22]</dt>
        <dd>
<span class="refAuthor">Bellare, M.</span>, <span class="refAuthor">Tessaro, S.</span>, and <span class="refAuthor">C. Zhu</span>, <span class="refTitle">"Stronger Security for Non-Interactive Threshold Signatures: BLS and FROST"</span>, <time datetime="2022-06-01" class="refDate">1 June 2022</time>, <span>&lt;<a href="https://eprint.iacr.org/2022/833">https://eprint.iacr.org/2022/833</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">This document was improved based on input and contributions by the Zcash Foundation engineering team.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prime-order-verify">
<section id="appendix-B">
      <h2 id="name-schnorr-signature-verificat">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-schnorr-signature-verificat" class="section-name selfRef">Schnorr Signature Verification for Prime-Order Groups</a>
      </h2>
<p id="appendix-B-1">This section contains a routine for verifying Schnorr signatures with validated inputs.
Specifically, it assumes that signature R component and public key belong to the
prime-order group.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>
  prime_order_verify(msg, sig, PK):

  Inputs:
  - msg, signed message, a byte string
  - sig, a tuple (R, z) output from signature generation
  - PK, public key, an Element

  Outputs: 1 if signature is valid, and 0 otherwise

  def prime_order_verify(msg, sig = (R, z), PK):
    comm_enc = G.SerializeElement(R)
    pk_enc = G.SerializeElement(PK)
    challenge_input = comm_enc || pk_enc || msg
    c = H2(challenge_input)

    l = G.ScalarBaseMult(z)
    r = R + G.ScalarMult(PK, c)
    return l == r
</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-dealer">
<section id="appendix-C">
      <h2 id="name-trusted-dealer-key-generati">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-trusted-dealer-key-generati" class="section-name selfRef">Trusted Dealer Key Generation</a>
      </h2>
<p id="appendix-C-1">One possible key generation mechanism is to depend on a trusted dealer, wherein the
dealer generates a group secret <code>s</code> uniformly at random and uses Shamir and Verifiable
Secret Sharing as described in <a href="#dep-shamir" class="xref">Appendix C.1</a> and <a href="#dep-vss" class="xref">Appendix C.2</a> to create secret
shares of <code>s</code> to be sent to all other participants. We highlight at a high level how this
operation can be performed.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The dealer is trusted to 1) generate good randomness, and 2) delete secret values after distributing shares to each participant,
and 3) keep secret values confidential.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C-3">
<pre>
  Inputs:
  - s, a group secret, Scalar, that MUST be derived from at least Ns bytes of entropy
  - MAX_SIGNERS, the number of shares to generate, an integer
  - MIN_SIGNERS, the threshold of the secret sharing scheme, an integer

  Outputs:
  - signer_private_keys, MAX_SIGNERS shares of the secret key s, each a tuple
    consisting of the participant identifier and the key share (a Scalar).
  - vss_commitment, a vector commitment of Elements in G, to each of the coefficients
    in the polynomial defined by secret_key_shares and whose first element is
    G.ScalarBaseMult(s).

  def trusted_dealer_keygen(s, MAX_SIGNERS, MIN_SIGNERS):
    signer_private_keys, coefficients = secret_share_shard(secret_key, MAX_SIGNERS, MIN_SIGNERS)
    vss_commitment = vss_commit(coefficients):
    PK = G.ScalarBaseMult(secret_key)
    return signer_private_keys, vss_commitment
</pre><a href="#appendix-C-3" class="pilcrow">¶</a>
</div>
<p id="appendix-C-4">It is assumed the dealer then sends one secret key share to each of the NUM_SIGNERS participants, along with <code>vss_commitment</code>.
After receiving their secret key share and <code>vss_commitment</code>, participants MUST abort if they do not have the same view of <code>vss_commitment</code>.
Otherwise, each participant MUST perform <code>vss_verify(secret_key_share_i, vss_commitment)</code>, and abort if the check fails.
The trusted dealer MUST delete the secret_key and secret_key_shares upon completion.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">Use of this method for key generation requires a mutually authenticated secure channel
between the dealer and participants to send secret key shares, wherein the channel provides confidentiality
and integrity. Mutually authenticated TLS is one possible deployment option.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<div id="dep-shamir">
<section id="appendix-C.1">
        <h3 id="name-shamir-secret-sharing">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-shamir-secret-sharing" class="section-name selfRef">Shamir Secret Sharing</a>
        </h3>
<p id="appendix-C.1-1">In Shamir secret sharing, a dealer distributes a secret <code>Scalar</code> <code>s</code> to <code>n</code> participants
in such a way that any cooperating subset of <code>MIN_SIGNERS</code> participants can recover the
secret. There are two basic steps in this scheme: (1) splitting a secret into
multiple shares, and (2) combining shares to reveal the resulting secret.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">This secret sharing scheme works over any field <code>F</code>. In this specification, <code>F</code> is
the scalar field of the prime-order group <code>G</code>.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">The procedure for splitting a secret into shares is as follows.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-4">
<pre>
  secret_share_shard(s, MAX_SIGNERS, MIN_SIGNERS):

  Inputs:
  - s, secret value to be shared, a Scalar
  - MAX_SIGNERS, the number of shares to generate, an integer
  - MIN_SIGNERS, the threshold of the secret sharing scheme, an integer

  Outputs:
  - secret_key_shares, A list of MAX_SIGNERS number of secret shares, each a tuple
    consisting of the participant identifier and the key share (a Scalar)
  - coefficients, a vector of the t coefficients which uniquely determine
    a polynomial f.

  Errors:
  - "invalid parameters", if MIN_SIGNERS &gt; MAX_SIGNERS or if MIN_SIGNERS is less than 2

  def secret_share_shard(s, MAX_SIGNERS, MIN_SIGNERS):
    if MIN_SIGNERS &gt; MAX_SIGNERS:
      raise "invalid parameters"
    if MIN_SIGNERS &lt; 2:
      raise "invalid parameters"

    # Generate random coefficients for the polynomial, yielding
    # a polynomial of degree (MIN_SIGNERS - 1)
    coefficients = [s]
    for i in range(1, MIN_SIGNERS):
      coefficients.append(G.RandomScalar())

    # Evaluate the polynomial for each point x=1,...,n
    secret_key_shares = []
    for x_i in range(1, MAX_SIGNERS + 1):
      y_i = polynomial_evaluate(Scalar(x_i), coefficients)
      secret_key_share_i = (x_i, y_i)
      secret_key_share.append(secret_key_share_i)
    return secret_key_shares, coefficients
</pre><a href="#appendix-C.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-5">Let <code>points</code> be the output of this function. The i-th element in <code>points</code> is
the share for the i-th participant, which is the randomly generated polynomial
evaluated at coordinate <code>i</code>. We denote a secret share as the tuple <code>(i, points[i])</code>,
and the list of these shares as <code>shares</code>.
<code>i</code> MUST never equal <code>0</code>; recall that <code>f(0) = s</code>, where <code>f</code> is the polynomial defined in a Shamir secret sharing operation.<a href="#appendix-C.1-5" class="pilcrow">¶</a></p>
<p id="appendix-C.1-6">The procedure for combining a <code>shares</code> list of length <code>MIN_SIGNERS</code> to recover the
secret <code>s</code> is as follows.<a href="#appendix-C.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-7">
<pre>
  secret_share_combine(shares):

  Inputs:
  - shares, a list of at minimum MIN_SIGNERS secret shares, each a tuple (i, f(i))
    where i is an identifier and f(i) is a Scalar

  Outputs: The resulting secret s, a Scalar, that was previously split into shares

  Errors:
  - "invalid parameters", if less than MIN_SIGNERS input shares are provided

  def secret_share_combine(shares):
    if len(shares) &lt; MIN_SIGNERS:
      raise "invalid parameters"
    scalar_shares = [(Scalar(x), y) for x, y in shares]
    s = polynomial_interpolation(scalar_shares)
    return s
</pre><a href="#appendix-C.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-vss">
<section id="appendix-C.2">
        <h3 id="name-verifiable-secret-sharing">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-verifiable-secret-sharing" class="section-name selfRef">Verifiable Secret Sharing</a>
        </h3>
<p id="appendix-C.2-1">Feldman's Verifiable Secret Sharing (VSS) builds upon Shamir secret sharing,
adding a verification step to demonstrate the consistency of a participant's
share with a public commitment to the polynomial <code>f</code> for which the secret <code>s</code>
is the constant term. This check ensure that all participants have a point
(their share) on the same polynomial, ensuring that they can later reconstruct
the correct secret.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">The procedure for committing to a polynomial <code>f</code> of degree <code>MIN_SIGNERS-1</code> is as follows.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-3">
<pre>
  vss_commit(coeffs):

  Inputs:
  - coeffs, a vector of the MIN_SIGNERS coefficients which uniquely determine
  a polynomial f.

  Outputs: a commitment vss_commitment, which is a vector commitment to each of the
  coefficients in coeffs, where each element of the vector commitment is an `Element` in `G`.

  def vss_commit(coeffs):
    vss_commitment = []
    for coeff in coeffs:
      A_i = G.ScalarBaseMult(coeff)
      vss_commitment.append(A_i)
    return vss_commitment
</pre><a href="#appendix-C.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-4">The procedure for verification of a participant's share is as follows.
If <code>vss_verify</code> fails, the participant MUST abort the protocol, and failure should be investigated out of band.<a href="#appendix-C.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-5">
<pre>
  vss_verify(share_i, vss_commitment):

  Inputs:
  - share_i: A tuple of the form (i, sk_i), where i indicates the participant
    identifier, and sk_i the participant's secret key, a secret share of the
    constant term of f, where sk_i is a Scalar.
  - vss_commitment: A VSS commitment to a secret polynomial f, a vector commitment
    to each of the coefficients in coeffs, where each element of the vector commitment
    is an Element

  Outputs: 1 if sk_i is valid, and 0 otherwise

  vss_verify(share_i, commitment)
    (i, sk_i) = share_i
    S_i = ScalarBaseMult(sk_i)
    S_i' = G.Identity()
    for j in range(0, MIN_SIGNERS):
      S_i' += G.ScalarMult(vss_commitment[j], pow(i, j))
    if S_i == S_i':
      return 1
    return 0
</pre><a href="#appendix-C.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-6">We now define how the Coordinator and signer participants can derive group info,
which is an input into the FROST signing protocol.<a href="#appendix-C.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-7">
<pre>
    derive_group_info(MAX_SIGNERS, MIN_SIGNERS, vss_commitment):

    Inputs:
    - MAX_SIGNERS, the number of shares to generate, an integer
    - MIN_SIGNERS, the threshold of the secret sharing scheme, an integer
    - vss_commitment: A VSS commitment to a secret polynomial f, a vector commitment to each of the
    coefficients in coeffs, where each element of the vector commitment is an Element in G.

    Outputs:
    - PK, the public key representing the group, an Element.
    - signer_public_keys, a list of MAX_SIGNERS public keys PK_i for i=1,...,MAX_SIGNERS,
      where each PK_i is the public key, an Element, for participant i.

    derive_group_info(MAX_SIGNERS, MIN_SIGNERS, vss_commitment)
      PK = vss_commitment[0]
      signer_public_keys = []
      for i in range(1, MAX_SIGNERS+1):
        PK_i = G.Identity()
        for j in range(0, MIN_SIGNERS):
          PK_i += G.ScalarMult(vss_commitment[j], pow(i, j))
        signer_public_keys.append(PK_i)
      return PK, signer_public_keys
</pre><a href="#appendix-C.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="random-scalar">
<section id="appendix-D">
      <h2 id="name-random-scalar-generation">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-random-scalar-generation" class="section-name selfRef">Random Scalar Generation</a>
      </h2>
<p id="appendix-D-1">Two popular algorithms for generating a random integer uniformly distributed in
the range [0, G.Order() -1] are as follows:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="rejection-sampling">
<section id="appendix-D.1">
        <h3 id="name-rejection-sampling">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-rejection-sampling" class="section-name selfRef">Rejection Sampling</a>
        </h3>
<p id="appendix-D.1-1">Generate a random byte array with <code>Ns</code> bytes, and attempt to map to a Scalar
by calling <code>DeserializeScalar</code>. If it succeeds, return the result. If it fails,
try again with another random byte array, until the procedure succeeds.<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
<p id="appendix-D.1-2">Note the that the Scalar size might be some bits smaller than the array size,
which can result in the loop iterating more times than required. In that case
it's acceptable to set the high-order bits to 0 before calling <code>DeserializeScalar</code>,
but care must be taken to not set to zero more bits than required. For example,
in the <code>FROST(Ed25519, SHA-512)</code> ciphersuite, the order has 253 bits while
the array has 256; thus the top 3 bits of the last byte can be set to zero.<a href="#appendix-D.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wide-reduction">
<section id="appendix-D.2">
        <h3 id="name-wide-reduction">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-wide-reduction" class="section-name selfRef">Wide Reduction</a>
        </h3>
<p id="appendix-D.2-1">Generate a random byte array with <code>L = ceil(((3 * ceil(log2(G.Order()))) / 2) / 8)</code>
bytes, and interpret it as an integer; reduce the integer modulo <code>G.Order()</code> and return the
result. See <span><a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5" class="relref">Section 5</a> of [<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>]</span> for the underlying derivation of <code>L</code>.<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="appendix-E">
      <h2 id="name-test-vectors">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-E-1">This section contains test vectors for all ciphersuites listed in <a href="#ciphersuites" class="xref">Section 6</a>.
All <code>Element</code> and <code>Scalar</code> values are represented in serialized form and encoded in
hexadecimal strings. Signatures are represented as the concatenation of their
constituent parts. The input message to be signed is also encoded as a hexadecimal
string.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Each test vector consists of the following information.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-3.1">Configuration: This lists the fixed parameters for the particular instantiation
of FROST, including MAX_SIGNERS, MIN_SIGNERS, and NUM_SIGNERS.<a href="#appendix-E-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-3.2">Group input parameters: This lists the group secret key and shared public key,
generated by a trusted dealer as described in <a href="#dep-dealer" class="xref">Appendix C</a>, as well as the
input message to be signed. All values are encoded as hexadecimal strings.<a href="#appendix-E-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-3.3">Signer input parameters: This lists the signing key share for each of the
NUM_SIGNERS signers.<a href="#appendix-E-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-3.4">Round one parameters and outputs: This lists the NUM_SIGNERS participants engaged
in the protocol, identified by their integer identifier, the hiding and binding commitment
values produced in <a href="#frost-round-one" class="xref">Section 5.1</a>, as well as the resulting group binding factor input,
computed in part from the group commitment list encoded as described in <a href="#dep-encoding" class="xref">Section 4.3</a>,
and group binding factor as computed in <a href="#frost-round-two" class="xref">Section 5.2</a>).<a href="#appendix-E-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-3.5">Round two parameters and outputs: This lists the NUM_SIGNERS participants engaged
in the protocol, identified by their integer identifier, along with their corresponding
output signature share as produced in <a href="#frost-round-two" class="xref">Section 5.2</a>.<a href="#appendix-E-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-E-3.6">Final output: This lists the aggregate signature as produced in <a href="#frost-aggregation" class="xref">Section 5.3</a>.<a href="#appendix-E-3.6" class="pilcrow">¶</a>
</li>
      </ul>
<div id="frosted25519-sha-512-1">
<section id="appendix-E.1">
        <h3 id="name-frosted25519-sha-512-2">
<a href="#appendix-E.1" class="section-number selfRef">E.1. </a><a href="#name-frosted25519-sha-512-2" class="section-name selfRef">FROST(Ed25519, SHA-512)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-E.1-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
MIN_SIGNERS: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 7b1c33d3f5291d85de664833beb1ad469f7fb6025a0ec78b3a7
90c6e13a98304
group_public_key: 15d21ccd7ee42959562fc8aa63224c8851fb3ec85a3faf66040
d380fb9738673
message: 74657374

// Signer input parameters
S1 signer_share: 929dcc590407aae7d388761cddb0c0db6f5627aea8e217f4a033
f2ec83d93509
S2 signer_share: a91e66e012e4364ac9aaa405fcafd370402d9859f7b6685c07ee
d76bf409e80d
S3 signer_share: d3cb090a075eb154e82fdb4b3cb507f110040905468bb9c46da8
bdea643a9a02

// Round one parameters
participants: 1,3

// Signer round one outputs
S1 hiding_nonce: 1c406170127e33142b8611bc02bf14d5909e49d5cb87150eff3e
c9804212920c
S1 binding_nonce: 5be4edde8b7acd79528721191626810c94fbc2bcc814b7a67d3
01fbd7fc16e07
S1 hiding_nonce_commitment: eab073cf90278e1796c2db197566c8d1f62f9992d
399a5329239481f9cbb5811
S1 binding_nonce_commitment: 13172c94dec7b22eb0a910e93fa1af8a79e27f61
b69981e1ebb227438ca3be84
S1 binding_factor_input: 25120720c3a416e292edfb0510780bc84eb734347a5f
d84dd46d0dcbf3a21d21a23a776628859678a968acc8c8564c4641a1fd4b29a12d536
7ca12ab10b6b497980a7514dabb157e25a78ab2f02572efad70a677a398de943abb9a
f16d2decc1197f36000ae9db37db3b39f3fbf9d854bbed9cb84d41973ac81af76ad63
7166a0001
S1 binding_factor: c538ab7707e484ba5d29bb80d9ac795e0542e8089debbaca4d
f090e92a6d5504
S3 hiding_nonce: 795f87122f05b7efc4b1a52f435c3d28597411b1a6fec198ce9c
818c5451c401
S3 binding_nonce: c9193aaef37bc074ea3286d0361c815f7201bf764cd9e7d8bb4
eb5ecca840a09
S3 hiding_nonce_commitment: 049e0a8d62db8fd2f8401fb027e0a51374f5c4c79
6a1765ecf14467df8c4829a
S3 binding_nonce_commitment: eeb691d3dc19e0dbc33471c7a7681a51801c481d
a34a8f55efe3070a75e9991d
S3 binding_factor_input: 25120720c3a416e292edfb0510780bc84eb734347a5f
d84dd46d0dcbf3a21d21a23a776628859678a968acc8c8564c4641a1fd4b29a12d536
7ca12ab10b6b497980a7514dabb157e25a78ab2f02572efad70a677a398de943abb9a
f16d2decc1197f36000ae9db37db3b39f3fbf9d854bbed9cb84d41973ac81af76ad63
7166a0003
S3 binding_factor: 9e4474b925576c54c8e50ec27e09a04537c837f38b0f71312a
58a8c12861b408

// Round two parameters
participants: 1,3

// Signer round two outputs
S1 sig_share: 1f16a3989b4aa2cc3782a503331b9a21d7ba56c9c5455d06981b542
5306c9d01
S3 sig_share: 4c8f33c301c05871b434a686847d5818417a01e50a59e9e7fddaefd
e7d244207

sig: 1aff2259ecb59cfcbb36ae77e02a9b134422abeae47cf7ff56c85fdf90932b18
6ba5d65b9d0afb3decb64b8ab798f239183558aed09e46ee95f64304ae90df08
</pre><a href="#appendix-E.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frosted448-shake256-1">
<section id="appendix-E.2">
        <h3 id="name-frosted448-shake256-2">
<a href="#appendix-E.2" class="section-number selfRef">E.2. </a><a href="#name-frosted448-shake256-2" class="section-name selfRef">FROST(Ed448, SHAKE256)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-E.2-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
MIN_SIGNERS: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 6298e1eef3c379392caaed061ed8a31033c9e9e3420726f23b4
04158a401cd9df24632adfe6b418dc942d8a091817dd8bd70e1c72ba52f3c00
group_public_key: 3832f82fda00ff5365b0376df705675b63d2a93c24c6e81d408
01ba265632be10f443f95968fadb70d10786827f30dc001c8d0f9b7c1d1b000
message: 74657374

// Signer input parameters
S1 signer_share: 4a2b2f5858a932ad3d3b18bd16e76ced3070d72fd79ae4402df2
01f525e754716a1bc1b87a502297f2a99d89ea054e0018eb55d39562fd0100
S2 signer_share: 2503d56c4f516444a45b080182b8a2ebbe4d9b2ab509f25308c8
8c0ea7ccdc44e2ef4fc4f63403a11b116372438a1e287265cadeff1fcb0700
S3 signer_share: 00db7a8146f995db0a7cf844ed89d8e94c2b5f259378ff66e39d
172828b264185ac4decf7219e4aa4478285b9c0eef4fccdf3eea69dd980d00

// Round one parameters
participants: 1,3

// Signer round one outputs
S1 hiding_nonce: f770bcb22f3c0acac7f09d3b757f13f31b53489776ede2cff944
b4c0cd28bb7dfbd33809e87201e152beeb552292eb748efa5267fa2dcd2000
S1 binding_nonce: d3196c7f14b1a99f1715053c00fa3a30b0fe9cbeb461068c262
b171478458a15598cc1c33cd415a766577996a6efcc520c411abf0280c81600
S1 hiding_nonce_commitment: dc4f663206390fff683379993f127aab5283d689e
b7940f3211f44112919fa67ac2976cf57c05e9f384a38f749eeeaf903a15ec4fa77a9
f900
S1 binding_nonce_commitment: 7e7bdf9d3489da9aa236b80d1ec8b3df9f0f3806
bce5921ce70750628e8db542558d574f998370dd5d347a020aef3e59d4186c0ac9e09
70500
S1 binding_factor_input: 766a004ac6e87a2fa70f2095b19596ac33b94e2f6803
e1a5b8fa8ea5adaf3e7989b2c167a38a42a1693ad69cfd674e089a498672753563d53
54654ba106d5fdffb134a8917fae91d412164436f734b95572af6208605744400c6ff
9a60fa2ce8fb7f3213414c32e347ee2e29e3d17654ef02c9f7802bacad53b0cbe1c4c
f746e7c97c54a848d20c161ce45e5e3f1fd70ff87b897f557b00e52399ed60f12b24b
99357c9c9d22838608b6f87200d4363437df7ab30374d1340b8efe5df213584a933ea
04566da6e3e85c1a0106b213a810cf4150e6a15e2418b352bf13e119c89e3f5ab8600
01
S1 binding_factor: 22d0ed444b4d42554270198e8e4d98fdf1bb3a159efb2254d6
8977f445f54e3fb580eaf40164f357f3ca5b9644de967b73a3497ad7d4e21000
S3 hiding_nonce: 9172a7cea56b7f564ed93116adf078ee013e4160e2687489ea58
0bc6f034f10e58db0b0cdf98bf1d3c85b2eb1f30b8b6df57b3611d205d2e00
S3 binding_nonce: 3b60b4dc036b21441620a36c84b0ec780267a9275b411a495b1
82dc6bfc812d1a21d93142d375b7ed80314d1693b61c1f42e20c575a4530e00
S3 hiding_nonce_commitment: 5150f6389c06c8cc32ab31e6ca15514f2073c91b1
2815b4e91dcc389d234a450bfeaa30e8befe23632f383566d7eb9d904a7530a3be6a9
f300
S3 binding_nonce_commitment: ce7231d5f89f6792f05a16f074e0fad1b6e3b1f2
f5f5e7bad894157cede68b4bc0621910900c59a3c6e1907301ff90a43b8a086aabdd0
ae080
S3 binding_factor_input: 766a004ac6e87a2fa70f2095b19596ac33b94e2f6803
e1a5b8fa8ea5adaf3e7989b2c167a38a42a1693ad69cfd674e089a498672753563d53
54654ba106d5fdffb134a8917fae91d412164436f734b95572af6208605744400c6ff
9a60fa2ce8fb7f3213414c32e347ee2e29e3d17654ef02c9f7802bacad53b0cbe1c4c
f746e7c97c54a848d20c161ce45e5e3f1fd70ff87b897f557b00e52399ed60f12b24b
99357c9c9d22838608b6f87200d4363437df7ab30374d1340b8efe5df213584a933ea
04566da6e3e85c1a0106b213a810cf4150e6a15e2418b352bf13e119c89e3f5ab8600
03
S3 binding_factor: 3e9156d4199b1057494ed34859d9770d9555879c399afed512
459cf8632e312598ad24e3d0e2d7c75a4d7f75e513fa5b7fd1f473d315191900

// Round two parameters
participants: 1,3

// Signer round two outputs
S1 sig_share: 95aeb18a46bac9e239d8eb51a7168da25a000d8a6938e26446c36e5
db88eff9523e0b09934558ddc8b2679bf2f10ed66415df1eb6e38a50700
S3 sig_share: 521672ae547cd95b94a9be55b72a0dfb6938715230304d39017f5a5
4f1333a96da50a0759eea78bdb6b670c8243dbe706cd388763fe4c50b00

sig: f1c2605fc0b724696dff10d2df0ac28939f40dc3d9ba864605462355c139229d
e643a6580e5807994cfcab0796644571c501cab00e85056a00e7c423399b36a33ece8
1aaa75e419a9dc4387edc99682f9e4742c9b1a9c2392cfe30510fd33f069a42dde987
544dabd7ad307a62ae1c6b1300
</pre><a href="#appendix-E.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frostristretto255-sha-512">
<section id="appendix-E.3">
        <h3 id="name-frostristretto255-sha-512-2">
<a href="#appendix-E.3" class="section-number selfRef">E.3. </a><a href="#name-frostristretto255-sha-512-2" class="section-name selfRef">FROST(ristretto255, SHA-512)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-E.3-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
MIN_SIGNERS: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 1b25a55e463cfd15cf14a5d3acc3d15053f08da49c8afcf3ab2
65f2ebc4f970b
group_public_key: e2a62f39eede11269e3bd5a7d97554f5ca384f9f6d3dd9c3c0d
05083c7254f57
message: 74657374

// Signer input parameters
S1 signer_share: 5c3430d391552f6e60ecdc093ff9f6f4488756aa6cebdbad75a7
68010b8f830e
S2 signer_share: b06fc5eac20b4f6e1b271d9df2343d843e1e1fb03c4cbb673f28
72d459ce6f01
S3 signer_share: f17e505f0e2581c6acfe54d3846a622834b5e7b50cad9a2109a9
7ba7a80d5c04

// Round one parameters
participants: 1,3

// Signer round one outputs
S1 hiding_nonce: 1eaee906e0554a5e533415e971eefa909f3c614c7c75e27f381b
0270a9afe308
S1 binding_nonce: 16175fc2e7545baf7180e8f5b6e1e73c4f2769323cc76754bdd
79fe93ab0bd0b
S1 hiding_nonce_commitment: 80d35700fda011d9e2b2fad4f237bf88f2978d954
382dfd36a517ab0497a474f
S1 binding_nonce_commitment: 40f0fecaf94e656b3f802ba9827fca9fa994c13c
98a5ff257973f8bdbc733324
S1 binding_factor_input: fe9082dcc1ae1ae11380ac4cf0b6e2770af565ff5af9
016254dc7c9d4869cbae0f6e4d94b23e5781b91bc74a25e0c773446b2640290d07c83
f0b067ff870a80179b2d1262816a7a4fad96b747bd6b35ccf4a912a793c5701d54852
db80904a767cbbd6e37377eec77f407b22890c01190995066cce59d88a14ac56ac40b
3bdc90001
S1 binding_factor: c0f5ee2613c448137bae256a4e95d56deb8c59f934332c0c00
41720b8819680f
S3 hiding_nonce: 48d78b8c2de1a515513f9d3fc464a19a72304fac522f17cc6477
06cb22c21403
S3 binding_nonce: 5c0f10966b3f1386660a87de0fafd69decbe9ffae1a152a88b7
d83bb4fb1c908
S3 hiding_nonce_commitment: 20dec6ad0795f82009a1a94b6ad79f01a1e95ae8e
308d8d8fae8285982308113
S3 binding_nonce_commitment: 98437dafb20fdb18255464072bee514889aeeec3
24f149d49747143c3613056d
S3 binding_factor_input: fe9082dcc1ae1ae11380ac4cf0b6e2770af565ff5af9
016254dc7c9d4869cbae0f6e4d94b23e5781b91bc74a25e0c773446b2640290d07c83
f0b067ff870a80179b2d1262816a7a4fad96b747bd6b35ccf4a912a793c5701d54852
db80904a767cbbd6e37377eec77f407b22890c01190995066cce59d88a14ac56ac40b
3bdc90003
S3 binding_factor: 8ea449e545706bb3b42c66423005451457e4bb4dea2c2d0b1d
157e6bb652ec09

// Round two parameters
participants: 1,3

// Signer round two outputs
S1 sig_share: 5ae13621ebeef844e39454eb3478a50c4531d25939e1065f44f5b04
a8535090e
S3 sig_share: aa432dcf274a9441c205e76fe43497be99efe374f9853477bd5add2
075f6970c

sig: 9c407badb8cacf10f306d94e31fb2a71d6a8398039802b4d80a1278472397206
17516e93f8d57a2ecffd43b83ab35db6de20b6ce32673bd601508e6bfa2ba10a
</pre><a href="#appendix-E.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frostp-256-sha-256-1">
<section id="appendix-E.4">
        <h3 id="name-frostp-256-sha-256-2">
<a href="#appendix-E.4" class="section-number selfRef">E.4. </a><a href="#name-frostp-256-sha-256-2" class="section-name selfRef">FROST(P-256, SHA-256)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-E.4-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
MIN_SIGNERS: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 8ba9bba2e0fd8c4767154d35a0b7562244a4aaf6f36c8fb8735
fa48b301bd8de
group_public_key: 023a309ad94e9fe8a7ba45dfc58f38bf091959d3c99cfbd02b4
dc00585ec45ab70
message: 74657374

// Signer input parameters
S1 signer_share: 0c9c1a0fe806c184add50bbdcac913dda73e482daf95dcb9f35d
bb0d8a9f7731
S2 signer_share: 8d8e787bef0ff6c2f494ca45f4dad198c6bee01212d6c8406715
9c52e1863ad5
S3 signer_share: 0e80d6e8f6192c003b5488ce1eec8f5429587d48cf001541e713
b2d53c09d928

// Round one parameters
participants: 1,3

// Signer round one outputs
S1 hiding_nonce: e9165dad654fc20a9e31ca6f32ac032ec327b551a50e8ac5cf25
f5c4c9e20757
S1 binding_nonce: e9059a232598a0fba0e495a687580e624ab425337c3221246fb
2c716905bc9e7
S1 hiding_nonce_commitment: 0228df2e7f6c254b40a9f8853cf6c4f21eacbb6f0
663027384966816b57e513304
S1 binding_nonce_commitment: 02f5b7f48786f8b83ebefed6249825650c4fa657
da66ae0da1b2613dedbe122ec8
S1 binding_factor_input: 3617acb73b44df565fbcbbbd1824142c473ad1d6c800
7c4b72a298d1eaae5766b730d2e6594ea697a5971f15e989ac47ecc015692ad88b615
a41e652a306c7e50001
S1 binding_factor: 95f987c0ab590507a8c4deaf506ffc182d3626e30386306f7a
b3aaf0b0013cd3
S3 hiding_nonce: b9d136e29eb758bd77cb83c317ac4e336cf8cda830c089deddf6
d5ec81da9884
S3 binding_nonce: 5261e2d00ce227e67bb9b38990294e2c82970f335b2e6d9f1d0
7a72ba43d01f0
S3 hiding_nonce_commitment: 02f87bd95ab5e08ea292a96e21caf9bdc5002ebf6
e3ce14f922817d26a4d08144d
S3 binding_nonce_commitment: 0263cb513e347fcf8492c7f97843ed4c3797f2f3
fe925b1e68f65fb90826fe9597
S3 binding_factor_input: 3617acb73b44df565fbcbbbd1824142c473ad1d6c800
7c4b72a298d1eaae5766b730d2e6594ea697a5971f15e989ac47ecc015692ad88b615
a41e652a306c7e50003
S3 binding_factor: 2f21db4f811b13f938a13b8f2633467d250703fe5bd63cd24f
08bef6fd2f3c29

// Round two parameters
participants: 1,3

// Signer round two outputs
S1 sig_share: bdaa275f10ca57e3a3a9a7a0d95aeabb517897d8482873a8f9713d4
58f94756f
S3 sig_share: 0e8fd85386939e8974a8748e66641df0fe043323c52487a2b10b8a3
97897de21

sig: 03c41521412528dce484c35b6b9b7cc8150102ab3e4bdf858d702270c05098e6
c6cc39ffb2975df66d18521c2f3fbf08ac4f7ccafc0d4cfb4baa7cc77f082c5390
</pre><a href="#appendix-E.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frostsecp256k1-sha-256-1">
<section id="appendix-E.5">
        <h3 id="name-frostsecp256k1-sha-256-2">
<a href="#appendix-E.5" class="section-number selfRef">E.5. </a><a href="#name-frostsecp256k1-sha-256-2" class="section-name selfRef">FROST(secp256k1, SHA-256)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-E.5-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
MIN_SIGNERS: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 0d004150d27c3bf2a42f312683d35fac7394b1e9e318249c1bf
e7f0795a83114
group_public_key: 02f37c34b66ced1fb51c34a90bdae006901f10625cc06c4f646
63b0eae87d87b4f
message: 74657374

// Signer input parameters
S1 signer_share: 08f89ffe80ac94dcb920c26f3f46140bfc7f95b493f8310f5fc1
ea2b01f4254c
S2 signer_share: 04f0feac2edcedc6ce1253b7fab8c86b856a797f44d83d82a385
554e6e401984
S3 signer_share: 00e95d59dd0d46b0e303e500b62b7ccb0e555d49f5b849f5e748
c071da8c0dbc

// Round one parameters
participants: 1,3

// Signer round one outputs
S1 hiding_nonce: 95f352cf568508bce96ef3cb816bf9229eb521ca9c2aff6a4fe8
b86bf49ae16f
S1 binding_nonce: c675aea50ff2510ae6b0fcb55432b97ad0b55a28b959bacb0e8
b466dbf43dd26
S1 hiding_nonce_commitment: 028acf8c9e345673e2544248006f4ba7ead5e94e1
70062b86eb532a74c26f79f98
S1 binding_nonce_commitment: 0314c33f75948224dd39cdffc68fa0faeeb42f7e
f94f1552c920196d53fbda04ce
S1 binding_factor_input: d759fa818c284537bbb2efa2d7247eac9232b7b992cd
49237106acab251dd9543f613ca4fea19d29cc54b4aa618e93289eff0da1a87fcebd1
d690283016126580001
S1 binding_factor: 6c7933abb7bc86bcc5c549ba984b9526dca099f9d9b787cedd
e20c70d36f5fc1
S3 hiding_nonce: b5089ebf363630d3477711005173c1419f4f40514f7287b4ca6f
f110967a2d70
S3 binding_nonce: 5e50ce9975cfc6164e85752f52094b11091fdbca846a9c245fd
bfa4bab1ae28c
S3 hiding_nonce_commitment: 039121f05be205b6a52ffdfdcd5f9cdc3b074a7f0
f031dac294e747b7ca83567d5
S3 binding_nonce_commitment: 0265c40f57bdcdcd0dfa43a8d353301e1474517b
70da29ddb1cb4461cd09eee1ce
S3 binding_factor_input: d759fa818c284537bbb2efa2d7247eac9232b7b992cd
49237106acab251dd9543f613ca4fea19d29cc54b4aa618e93289eff0da1a87fcebd1
d690283016126580003
S3 binding_factor: 1b18e710a470fe513e4387c613321aa41151990f65a8577343
b45d6883ab877d

// Round two parameters
participants: 1,3

// Signer round two outputs
S1 sig_share: 280c44c6c37cd64c7f5a552ae8416a57d21c115cab524dbff5fbceb
bf5c0019d
S3 sig_share: e372bca35133a80ca140dcac2125c966b763a934678f40e09fb8b0a
e9d4aee1b

sig: 0364b02292a4b0e61f849f4d6fac0e67c2f698a21e1cba9e4a5b8fa535f2f931
0d0b7f016a14b07e59209b31d7096733bfced0ddaa6398ee64d5e220ddc2d4ae77
</pre><a href="#appendix-E.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Deirdre Connolly</span></div>
<div dir="auto" class="left"><span class="org">Zcash Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:durumcrustulum@gmail.com" class="email">durumcrustulum@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chelsea Komlo</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo, Zcash Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ckomlo@uwaterloo.ca" class="email">ckomlo@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ian Goldberg</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:iang@uwaterloo.ca" class="email">iang@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
